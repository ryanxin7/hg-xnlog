<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>kubernetes RBAC鉴权机制与多用户实例 - Ryan&#39;s Notebook</title><meta name="author" content="Ryan">
<meta name="author-link" content="https://github.com/ryanxin7">
<meta name="description" content="1.概述 基于角色的访问控制（Role-Based Access Control，RBAC）是一种广泛应用的访问控制模型，它基于用户的角色来管理对系统资源的" /><meta name="keywords" content='kubernetes基础' /><meta itemprop="name" content="kubernetes RBAC鉴权机制与多用户实例">
<meta itemprop="description" content="1.概述 基于角色的访问控制（Role-Based Access Control，RBAC）是一种广泛应用的访问控制模型，它基于用户的角色来管理对系统资源的"><meta itemprop="datePublished" content="2024-01-04T00:00:00+00:00" />
<meta itemprop="dateModified" content="2024-01-04T00:00:00+00:00" />
<meta itemprop="wordCount" content="4094"><meta itemprop="image" content="https://hg-xnlog.github.io/logo.png"/>
<meta itemprop="keywords" content="kubernetes基础," /><meta property="og:title" content="kubernetes RBAC鉴权机制与多用户实例" />
<meta property="og:description" content="1.概述 基于角色的访问控制（Role-Based Access Control，RBAC）是一种广泛应用的访问控制模型，它基于用户的角色来管理对系统资源的" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" /><meta property="og:image" content="https://hg-xnlog.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-01-04T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://hg-xnlog.github.io/logo.png"/>

<meta name="twitter:title" content="kubernetes RBAC鉴权机制与多用户实例"/>
<meta name="twitter:description" content="1.概述 基于角色的访问控制（Role-Based Access Control，RBAC）是一种广泛应用的访问控制模型，它基于用户的角色来管理对系统资源的"/>
<meta name="application-name" content="Ryan’s Notebook">
<meta name="apple-mobile-web-app-title" content="Ryan’s Notebook"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" /><link rel="prev" href="https://hg-xnlog.github.io/posts/20000/lesson5/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "kubernetes RBAC鉴权机制与多用户实例",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/hg-xnlog.github.io\/posts\/kubernetes\/primary\/kubernetes-rbac-and-multi-user-instances\/"
    },"genre": "posts","keywords": "kubernetes基础","wordcount":  4094 ,
    "url": "https:\/\/hg-xnlog.github.io\/posts\/kubernetes\/primary\/kubernetes-rbac-and-multi-user-instances\/","datePublished": "2024-01-04T00:00:00+00:00","dateModified": "2024-01-04T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Ryan"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="wide"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper" data-github-corner="right">
    <div class="header-title">
      <a href="/" title="Ryan&#39;s Notebook"><img loading="lazy" src="/images/pow.png" srcset="/images/pow.png, /images/pow.png 1.5x, /images/pow.png 2x" sizes="auto" data-title="Ryan&#39;s Notebook" data-alt="Ryan&#39;s Notebook" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span class="header-title-text">Ryan’s Notebook</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 所有文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/friends/"
                title="友情链接"
                
              ><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-solid fa-user-tie fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Ryan&#39;s Notebook"><img loading="lazy" src="/images/pow.png" srcset="/images/pow.png, /images/pow.png 1.5x, /images/pow.png 2x" sizes="auto" data-title="/images/pow.png" data-alt="/images/pow.png" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span class="header-title-text">Ryan’s Notebook</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 所有文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/friends/"
                  title="友情链接"
                  
                ><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-solid fa-user-tie fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li
              class="menu-item text-center"
            ><a
                  class="menu-link"
                  href="https://github.com/ryanxin7/hg-xnlog"
                  title="GitHub"
                  rel="noopener noreferrer" target="_blank"
                ><i class='fa-brands fa-github fa-fw' aria-hidden='true'></i> </a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="toc" id="toc-auto"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>kubernetes RBAC鉴权机制与多用户实例</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://github.com/ryanxin7" title="作者"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img loading="lazy" src="/images/avatar.png" srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes="auto" data-title="Ryan" data-alt="Ryan" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;Ryan</a></span>
          <span class="post-category">收录于 <a href="/categories/kubernetes/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Kubernetes</a></span></div>
      <div class="post-meta-line"><span title="发布于 2024-01-04 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden="true"></i><time datetime="2024-01-04">2024-01-04</time></span>&nbsp;<span title="更新于 2024-01-04 00:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden="true"></i><time datetime="2024-01-04">2024-01-04</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 4094 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 9 分钟</span>&nbsp;<span id="busuanzi_container_page_pv" class="busuanzi_visitors comment-visitors" data-flag-title="kubernetes RBAC鉴权机制与多用户实例">
            <i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_page_pv">-</span>&nbsp;次阅读
          </span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1概述">1.概述</a></li>
    <li><a href="#2api-对象">2.API 对象</a>
      <ul>
        <li><a href="#21--role-和-clusterrole-的作用范围以及用途">2.1  Role 和 ClusterRole 的作用范围以及用途</a></li>
        <li><a href="#22-rolebinding-和-clusterrolebinding">2.2 RoleBinding 和 ClusterRoleBinding</a></li>
      </ul>
    </li>
    <li><a href="#3引用资源">3.引用资源</a></li>
    <li><a href="#4多用户实例">4.多用户实例</a>
      <ul>
        <li><a href="#41-创建role只读角色">4.1 创建role只读角色</a></li>
        <li><a href="#42-创建rolebinding">4.2 创建rolebinding</a></li>
        <li><a href="#43-将规则与账户进行绑定">4.3 将规则与账户进行绑定</a></li>
        <li><a href="#44-获取token名称">4.4 获取Token名称</a></li>
        <li><a href="#45-使用base64加密并登录测试">4.5 使用base64加密并登录测试</a></li>
        <li><a href="#46-基于kube-config文件登录">4.6 基于kube-config文件登录</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 id="1概述">1.概述</h2>
<p>基于角色的访问控制（<strong>Role-Based Access Control</strong>，<strong>RBAC</strong>）是一种广泛应用的访问控制模型，它基于用户的角色来管理对系统资源的访问权限。在RBAC中，访问控制是根据用户的角色分配的，而不是直接将权限分配给个体用户。</p>
<!-- raw HTML omitted -->
<p><img loading="lazy" src="https://cdn1.ryanxin.live/image.png" srcset="https://cdn1.ryanxin.live/image.png, https://cdn1.ryanxin.live/image.png 1.5x, https://cdn1.ryanxin.live/image.png 2x" sizes="auto" data-title="https://cdn1.ryanxin.live/image.png" data-alt="https://cdn1.ryanxin.live/image.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p><code>rbac.authorization.k8s.io</code>  API组是Kubernetes中用于管理RBAC策略的一部分。</p>
<p>通过使用这个API组，您可以定义 <strong>角色（Role）、集群角色（ClusterRole）、角色绑定（RoleBinding）、集群角色绑定（ClusterRoleBinding）</strong> 等资源对象，以控制对 Kubernetes API 中不同资源的访问权限。</p>
<p>要在 Kubernetes 中启用 RBAC，需要在启动 API 服务器时设置 <code>--authorization-mode</code> 参数，并确保将 RBAC 作为其中的一个授权模式。</p>
<div class="highlight" id="id-1"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> --authorization-mode<span class="o">=</span>Node,RBAC, --&lt;其他选项&gt; --&lt;其他选项&gt;</span></span></code></pre></div><!-- raw HTML omitted -->
<h2 id="2api-对象">2.API 对象</h2>
<p><strong>RBAC API 声明了四种 Kubernetes 对象</strong>：</p>
<ul>
<li>
<p><strong>Role（角色）</strong>：Role 对象定义了一组规则，用于指定在单个命名空间内对资源的访问权限。它可以授予特定命名空间内用户或服务账户对资源的访问权限。</p>
</li>
<li>
<p><strong>ClusterRole（集群角色）</strong>：ClusterRole 与 Role 类似，不过它的作用范围不限于单个命名空间。ClusterRole 可以授予对整个集群范围内资源的访问权限。</p>
</li>
<li>
<p><strong>RoleBinding（角色绑定）</strong>：RoleBinding 将 Role 或 ClusterRole 与用户、组、服务账户等主体绑定在一起，赋予它们相应的权限。它用于将角色与实际的用户或实体关联起来，使其能够访问特定的资源。</p>
</li>
<li>
<p><strong>ClusterRoleBinding（集群角色绑定）</strong>：与 RoleBinding 类似，但 ClusterRoleBinding 是将 ClusterRole 与用户、组、服务账户等主体绑定，授予在整个集群范围内的资源访问权限。</p>
</li>
</ul>
<p>通过 kubectl 这样的命令行工具，可以像管理其他 Kubernetes 对象一样来描述、创建、更新或删除 RBAC 对象</p>
<!-- raw HTML omitted -->
<h3 id="21--role-和-clusterrole-的作用范围以及用途">2.1  Role 和 ClusterRole 的作用范围以及用途</h3>
<p><strong>Role 对象是针对某个特定命名空间（Namespace）内的资源定义访问权限的。</strong>
创建 Role 时，必须将其绑定到特定的命名空间，并且它只能赋予该命名空间内资源的权限。</p>
<p>在 Role 中定义的规则和权限是在特定命名空间内生效的，例如，可以定义一个 Role 来管理某个命名空间内的 Pod、Service 或其它资源的访问权限。</p>
<!-- raw HTML omitted -->
<p><strong>ClusterRole 是集群级别的资源，不受限于单个命名空间</strong>。</p>
<p>ClusterRole 可以授予单个或多个命名空间内的用户或服务账户,也可以在整个集群定义针对整个集群范围的资源（例如节点、PersistentVolumes 等）的访问权限。可以被广泛地应用于不同的命名空间，甚至整个集群，赋予对资源更广泛的访问权限。</p>
<!-- raw HTML omitted -->
<p><strong>Role 用于管理单个命名空间内的资源访问权限，而 ClusterRole 则用于更广泛的授权需求</strong>，例如跨多个命名空间或整个集群的资源管理。</p>
<p>这两种资源的区别在于其作用范围不同，因此在设计 RBAC 策略时，可以根据需要选择使用适当的资源类型来定义和管理权限。</p>
<!-- raw HTML omitted -->
<p><strong>Role 示例</strong></p>
<div class="highlight" id="id-2"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Role</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">xinn </span><span class="w"> </span><span class="c"># 命名空间</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pod-reader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;pods&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;get&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;list&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;watch&#34;</span><span class="p">]</span></span></span></code></pre></div><p><strong><code>apiVersion</code></strong> 指定了 RBAC API 的版本。
<strong><code>kind</code></strong> 指定了要创建的对象类型，这里是一个 Role。
<strong><code>metadata</code></strong> 中包含了元数据信息，其中 namespace 是该 Role 所属的命名空间，name 是该 Role 的名称。
<strong><code>rules</code></strong> 列表定义了该 Role 的访问规则：
<strong><code>apiGroups</code></strong> 定义了资源所属的 API 组，空字符串表示核心 API 组。
<strong><code>resources</code></strong> 是权限所应用的资源类型，这里是 &ldquo;pods&rdquo;，表示 Pod 资源。
<strong><code>verbs</code></strong> 是允许的操作，这里允许 &ldquo;get&rdquo;、&ldquo;list&rdquo; 和 &ldquo;watch&rdquo; 操作，允许用户读取（获取）、列出和监视 Pod 资源。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>ClusterRole 示例</strong></p>
<div class="highlight" id="id-3"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterRole</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">secret-reader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;secrets&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;get&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;list&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;watch&#34;</span><span class="p">]</span></span></span></code></pre></div><!-- raw HTML omitted -->
<h3 id="22-rolebinding-和-clusterrolebinding">2.2 RoleBinding 和 ClusterRoleBinding</h3>
<ul>
<li>
<p>RoleBinding 用于将 Role 对象与特定命名空间内的用户、组或服务账户等主体绑定在一起，从而赋予这些主体相应 Role 中定义的权限。</p>
</li>
<li>
<p>ClusterRoleBinding 用于将 ClusterRole 对象与集群内的用户、组或服务账户等主体绑定在一起，从而赋予这些主体相应 ClusterRole 中定义的权限。
与 RoleBinding 不同，ClusterRoleBinding 在整个集群范围内生效，而不是针对单个命名空间。</p>
</li>
</ul>
<p><strong>RoleBinding 示例</strong></p>
<div class="highlight" id="id-4"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">RoleBinding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pod-reader-binding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">your-namespace</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">subjects</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">User </span><span class="w"> </span><span class="c"># 主体类型（User、Group、ServiceAccount 等）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">user1 </span><span class="w"> </span><span class="c"># 主体名称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">roleRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Role </span><span class="w"> </span><span class="c"># 绑定的角色类型（Role 或 ClusterRole）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pod-reader </span><span class="w"> </span><span class="c"># 角色名称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io</span></span></span></code></pre></div><!-- raw HTML omitted -->
<p><strong>ClusterRoleBinding 示例</strong></p>
<div class="highlight" id="id-5"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterRoleBinding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">secret-reader-binding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">subjects</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ServiceAccount </span><span class="w"> </span><span class="c"># 主体类型（User、Group、ServiceAccount 等）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">my-service-account </span><span class="w"> </span><span class="c"># 主体名称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">your-namespace </span><span class="w"> </span><span class="c"># 所属命名空间</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">roleRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterRole </span><span class="w"> </span><span class="c"># 绑定的角色类型（ClusterRole）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">secret-reader </span><span class="w"> </span><span class="c"># 角色名称</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io</span></span></span></code></pre></div><!-- raw HTML omitted -->
<h2 id="3引用资源">3.引用资源</h2>
<p>在 Kubernetes RBAC 中，可以使用资源的名称来引用其子资源。子资源是 Kubernetes API 的一部分，允许对主资源执行特定操作或获取相关信息。RBAC 角色表达子资源时，使用斜线（/）来分隔资源和子资源。</p>
<p><strong>子资源示例：</strong>
允许特定主体读取 Pod 资源以及访问这些 Pod 的日志子资源</p>
<div class="highlight" id="id-6"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Role</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pod-and-pod-logs-reader</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;pods&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;pods/log&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;get&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;list&#34;</span><span class="p">]</span></span></span></code></pre></div><!-- raw HTML omitted -->
<p><strong>限制访问的具体资源名称示例</strong>
允许特定主体对名为 my-configmap 的 ConfigMap 进行 &ldquo;update&rdquo; 和 &ldquo;get&rdquo; 操作。</p>
<div class="highlight" id="id-7"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Role</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">configmap-updater</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># 在 HTTP 层面，用来访问 ConfigMap 资源的名称为 &#34;configmaps&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;configmaps&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resourceNames</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;my-configmap&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;update&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;get&#34;</span><span class="p">]</span></span></span></code></pre></div><!-- raw HTML omitted -->
<h2 id="4多用户实例">4.多用户实例</h2>
<p>创建一个只读账号</p>
<h3 id="41-创建role只读角色">4.1 创建role只读角色</h3>
<div class="highlight" id="id-8"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create serviceaccount xinn-user1 -n xinn
</span></span><span class="line"><span class="cl">serviceaccount/xinn-user1 created</span></span></code></pre></div><h3 id="42-创建rolebinding">4.2 创建rolebinding</h3>
<div class="highlight" id="id-9"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Role</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">xinn</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2-role</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;pods&#34;</span><span class="p">,</span><span class="s2">&#34;pods/exec&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;get&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;list&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;watch&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;apps&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;deployments&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;get&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;list&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;watch&#34;</span><span class="p">]</span></span></span></code></pre></div><div class="highlight" id="id-10"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -f xinn-user2-role.yaml
</span></span><span class="line"><span class="cl">role.rbac.authorization.k8s.io/xinn-user2-role created</span></span></code></pre></div><h3 id="43-将规则与账户进行绑定">4.3 将规则与账户进行绑定</h3>
<div class="highlight" id="id-11"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">RoleBinding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">role-binding-xinn-user2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">xinn</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">subjects</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ServiceAccount</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">xinn</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">roleRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Role</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2-role</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io</span></span></span></code></pre></div><div class="highlight" id="id-12"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@k8s-made-01-32:~# kubectl apply -f xinn-user2-role-binding.yaml
</span></span><span class="line"><span class="cl">rolebinding.rbac.authorization.k8s.io/xinn-user2-role-binding created</span></span></code></pre></div><h3 id="44-获取token名称">4.4 获取Token名称</h3>
<div class="details admonition question open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-question-circle fa-fw" aria-hidden="true"></i>问题<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">从 Kubernetes v1.24 版本开始，引入了 <a href="https://kubernetes.io/zh-cn/docs/reference/command-line-tools-reference/feature-gates/#feature-gates-for-graduated-or-deprecated-features"target="_blank" rel="external nofollow noopener noreferrer"><strong>LegacyServiceAccountTokenNoAutoGeneration</strong> 特性门控</a>，默认情况下启用以至于 Kubernetes 不会自动为 ServiceAccount 创建与令牌相关的 Secrets。如果需要使用服务账号的令牌进行认证和授权需要手动创建这些 Secrets。</div>
    </div>
  </div>
<p><strong>创建ServiceAccount</strong></p>
<div class="highlight" id="id-13"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ServiceAccount</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">xinn</span></span></span></code></pre></div><div class="highlight" id="id-14"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 查看 ServiceAccount 详细信息，发现没有对 Token 进行自动创建</span>
</span></span><span class="line"><span class="cl">kubectl describe sa -n xinn xinn-user2
</span></span><span class="line"><span class="cl">Name:                xinn-user2
</span></span><span class="line"><span class="cl">Namespace:           xinn
</span></span><span class="line"><span class="cl">Labels:              &lt;none&gt;
</span></span><span class="line"><span class="cl">Annotations:         &lt;none&gt;
</span></span><span class="line"><span class="cl">Image pull secrets:  &lt;none&gt;
</span></span><span class="line"><span class="cl">Mountable secrets:   &lt;none&gt;
</span></span><span class="line"><span class="cl">Tokens:              &lt;none&gt;
</span></span><span class="line"><span class="cl">Events:              &lt;none&gt;</span></span></code></pre></div><p><strong>创建 SA 账号 Secret 并关联</strong></p>
<div class="highlight" id="id-15"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">关联apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">kubernetes.io/service-account-token</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2-secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">xinn</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">kubernetes.io/service-account.name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;xinn-user2&#34;</span><span class="w"> </span><span class="c">## 关联SA 账号</span></span></span></code></pre></div><p><strong>再次查看 ServiceAccount 确认已对 Secret 关联</strong></p>
<div class="highlight" id="id-16"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl describe sa -n xinn xinn-user2
</span></span><span class="line"><span class="cl">Name:                xinn-user2
</span></span><span class="line"><span class="cl">Namespace:           xinn
</span></span><span class="line"><span class="cl">Labels:              &lt;none&gt;
</span></span><span class="line"><span class="cl">Annotations:         &lt;none&gt;
</span></span><span class="line"><span class="cl">Image pull secrets:  &lt;none&gt;
</span></span><span class="line"><span class="cl">Mountable secrets:   &lt;none&gt;
</span></span><span class="line"><span class="cl">Tokens:              xinn-user2-secret
</span></span><span class="line"><span class="cl">Events:              &lt;none&gt;</span></span></code></pre></div><p><strong>查看 Secret 详细信息</strong></p>
<div class="highlight" id="id-17"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@k8s-made-01-32:~# kubectl describe -n xinn secrets xinn-user2-secret
</span></span><span class="line"><span class="cl">Name:         xinn-user2-secret
</span></span><span class="line"><span class="cl">Namespace:    xinn
</span></span><span class="line"><span class="cl">Labels:       &lt;none&gt;
</span></span><span class="line"><span class="cl">Annotations:  kubernetes.io/service-account.name: xinn-user2
</span></span><span class="line"><span class="cl">              kubernetes.io/service-account.uid: b3844090-c036-487a-a07c-b5b6dbe30688
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Type:  kubernetes.io/service-account-token
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">Data</span>
</span></span><span class="line"><span class="cl"><span class="o">====</span>
</span></span><span class="line"><span class="cl">token:      eyJhbGciOiJSUzI1NiIsImtpZCI6Il82SWdMUWRGbnlHeGEtQnpReDVvUE9PWW9yWXY4cmg0NWdsT2ZiNTZiY0UifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJ4aW5uIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6Inhpbm4tdXNlcjItc2VjcmV0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6Inhpbm4tdXNlcjIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiJiMzg0NDA5MC1jMDM2LTQ4N2EtYTA3Yy1iNWI2ZGJlMzA2ODgiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6eGlubjp4aW5uLXVzZXIyIn0.dhVVB0_aYhXmJEcgoqa6ZR9jkOvQv5nnDIyfdmTHyfgiNSX7TbDTZD1ncmZOH0uZNVkT4ja7Gpn371upEBuUnIsnnhb8PCS51WyUiKUTGzo7G48u_M6aS4n7tVcZY7YG7TYtG-t5gzaK2gPVX9ipanlsrwg1wxpEXUP5WHKXvkN8fqMw1YAFxs0BJspntC9YcD-sH2GUDoQhNVi4rFp_ye2cAdnzgBRFKdk0og2dm5LhEYy8F_cgztxFk1OUzLiRBi31w5SY1O0AFhHmv--4fWUWjeNIIerqXN7D_rio6_xgE04WEvZDi6G5nb1y7DlXjNlSAIhCo_w7CxdunQzREA
</span></span><span class="line"><span class="cl">ca.crt:     <span class="m">1310</span> bytes
</span></span><span class="line"><span class="cl">namespace:  <span class="m">4</span> bytes</span></span></code></pre></div><h3 id="45-使用base64加密并登录测试">4.5 使用base64加密并登录测试</h3>
<p><strong>获取SA Token</strong></p>
<div class="highlight" id="id-18"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@k8s-made-01-32:~# kubectl get secret -n xinn xinn-user2-secret  -o <span class="nv">jsonpath</span><span class="o">={</span><span class="s2">&#34;.data.token&#34;</span><span class="o">}</span> <span class="p">|</span> base64 -d
</span></span><span class="line"><span class="cl">eyJhbGciOiJSUzI1NiIsImtpZCI6Il82SWdMUWRGbnlHeGEtQnpReDVvUE9PWW9yWXY4cmg0NWdsT2ZiNTZiY0UifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJ4aW5uIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6Inhpbm4tdXNlcjItc2VjcmV0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6Inhpbm4tdXNlcjIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiJiMzg0NDA5MC1jMDM2LTQ4N2EtYTA3Yy1iNWI2ZGJlMzA2ODgiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6eGlubjp4aW5uLXVzZXIyIn0.dhVVB0_aYhXmJEcgoqa6ZR9jkOvQv5nnDIyfdmTHyfgiNSX7TbDTZD1ncmZOH0uZNVkT4ja7Gpn371upEBuUnIsnnhb8PCS51WyUiKUTGzo7G48u_M6aS4n7tVcZY7YG7TYtG-t5gzaK2gPVX9ipanlsrwg1wxpEXUP5WHKXvkN8fqMw1YAFxs0BJspntC9YcD-sH2GUDoQhNVi4rFp_ye2cAdnzgBRFKdk0og2dm5LhEYy8F_cgztxFk1OUzLiRBi31w5SY1O0AFhHmv--4fWUWjeNIIerqXN7D_rio6_xgE04WEvZDi6G5nb1y7DlXjNlSAIhCo_w7CxdunQzREAroot@k8s-made-01-32:~#</span></span></code></pre></div><p><strong>Kubernetes Dashboard 登录测试</strong></p>
<p><img loading="lazy" src="https://cdn1.ryanxin.live/image-20240104155842003.png" srcset="https://cdn1.ryanxin.live/image-20240104155842003.png, https://cdn1.ryanxin.live/image-20240104155842003.png 1.5x, https://cdn1.ryanxin.live/image-20240104155842003.png 2x" sizes="auto" data-title="image-20240104155842003" data-alt="image-20240104155842003" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p><img loading="lazy" src="https://cdn1.ryanxin.live/image-20240104160312671.png" srcset="https://cdn1.ryanxin.live/image-20240104160312671.png, https://cdn1.ryanxin.live/image-20240104160312671.png 1.5x, https://cdn1.ryanxin.live/image-20240104160312671.png 2x" sizes="auto" data-title="https://cdn1.ryanxin.live/image-20240104160312671.png" data-alt="https://cdn1.ryanxin.live/image-20240104160312671.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<!-- raw HTML omitted -->
<h3 id="46-基于kube-config文件登录">4.6 基于kube-config文件登录</h3>
<h4 id="461-创建csr请求文件">4.6.1 创建csr请求文件</h4>
<div class="highlight" id="id-19"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">#</span> <span class="err">cat</span> <span class="err">xinn-user</span><span class="mi">2</span><span class="err">-csr.json</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;CN&#34;</span><span class="p">:</span> <span class="s2">&#34;xinn-user2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;hosts&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;algo&#34;</span><span class="p">:</span> <span class="s2">&#34;rsa&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;size&#34;</span><span class="p">:</span> <span class="mi">2048</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;names&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;C&#34;</span><span class="p">:</span> <span class="s2">&#34;CN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;ST&#34;</span><span class="p">:</span> <span class="s2">&#34;BeiJing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;L&#34;</span><span class="p">:</span> <span class="s2">&#34;BeiJing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;O&#34;</span><span class="p">:</span> <span class="s2">&#34;k8s&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;OU&#34;</span><span class="p">:</span> <span class="s2">&#34;System&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div><h4 id="462-签发证书">4.6.2 签发证书</h4>
<p>使用 CFSSL 工具根据提供的 CSR 文件 <code>xinn-user1-csr.json</code> 生成证书。</p>
<div class="highlight" id="id-20"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@k8s-made-01-32:~# ln -sv /etc/kubeasz/bin/cfssl* /usr/bin/
</span></span><span class="line"><span class="cl"><span class="s1">&#39;/usr/bin/cfssl&#39;</span> -&gt; <span class="s1">&#39;/etc/kubeasz/bin/cfssl&#39;</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;/usr/bin/cfssl-certinfo&#39;</span> -&gt; <span class="s1">&#39;/etc/kubeasz/bin/cfssl-certinfo&#39;</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;/usr/bin/cfssljson&#39;</span> -&gt; <span class="s1">&#39;/etc/kubeasz/bin/cfssljson&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cfssl gencert -ca<span class="o">=</span>/etc/kubernetes/ssl/ca.pem -ca-key<span class="o">=</span>/etc/kubernetes/ssl/ca-key.pem -config<span class="o">=</span>/etc/kubeasz/clusters/xx-prod/ssl/ca-config.json -profile<span class="o">=</span>kubernetes xinn-user2-csr.json <span class="p">|</span> cfssljson -bare xinn-user2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#-ca 指定了 CA 证书的路径。</span>
</span></span><span class="line"><span class="cl"><span class="c1">#-ca-key 指定了 CA 的私钥路径。</span>
</span></span><span class="line"><span class="cl"><span class="c1">#-config 指定了 CA 配置文件的路径，其中包含了 CA 的配置信息和证书配置。</span>
</span></span><span class="line"><span class="cl"><span class="c1">#-profile 指定了使用的证书配置文件中的配置文件。</span>
</span></span><span class="line"><span class="cl"><span class="c1">#使用 cfssljson 命令处理结果，将其输出为 &#34;user1.pem&#34;, &#34;user1.csr&#34;, &#34;user1-key.pem&#34; 这些文件。</span></span></span></code></pre></div><div class="highlight" id="id-21"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls <span class="p">|</span> grep user2
</span></span><span class="line"><span class="cl">xinn-user2.csr
</span></span><span class="line"><span class="cl">xinn-user2-csr.json
</span></span><span class="line"><span class="cl">xinn-user2-key.pem
</span></span><span class="line"><span class="cl">xinn-user2.pem</span></span></code></pre></div><h4 id="463-生成普通用户kubeconfig文件">4.6.3 生成普通用户kubeconfig文件</h4>
<div class="highlight" id="id-22"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@k8s-made-01-32:~#  kubectl config set-cluster xx-prod --certificate-authority<span class="o">=</span>/etc/kubernetes/ssl/ca.pem --embed-certs<span class="o">=</span><span class="nb">true</span> --server<span class="o">=</span>https://10.1.0.32:6443,https://10.1.0.33:6443 --kubeconfig<span class="o">=</span>xinn-user2.kubeconfig
</span></span><span class="line"><span class="cl">Cluster <span class="s2">&#34;xx-prod&#34;</span> set.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="c1">#--embed-certs=true为嵌入证书信息</span></span></span></code></pre></div><div class="highlight" id="id-23"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">root@k8s-made-01-32:~# cat xinn-user2.kubeconfig</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">clusters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">cluster</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">certificate-authority-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURtakNDQW9LZ0F3SUJBZ0lVTnhMZWE2QTZvVC9HL0dnR24rZ01uRDJjR2VBd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pERUxNQWtHQTFVRUJoTUNRMDR4RVRBUEJnTlZCQWdUQ0VoaGJtZGFhRzkxTVFzd0NRWURWUVFIRXdKWQpVekVNTUFvR0ExVUVDaE1EYXpoek1ROHdEUVlEVlFRTEV3WlRlWE4wWlcweEZqQVVCZ05WQkFNVERXdDFZbVZ5CmJtVjBaWE10WTJFd0lCY05Nak13TmpFME1EazBPVEF3V2hnUE1qRXlNekExTWpFd09UUTVNREJhTUdReEN6QUoKQmdOVkJBWVRBa05PTVJFd0R3WURWUVFJRXdoSVlXNW5XbWh2ZFRFTE1Ba0dBMVVFQnhNQ1dGTXhEREFLQmdOVgpCQW9UQTJzNGN6RVBNQTBHQTFVRUN4TUdVM2x6ZEdWdE1SWXdGQVlEVlFRREV3MXJkV0psY201bGRHVnpMV05oCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBckNRN2VwV2RqTCtEMXNVY0FacXgKdjcrRGxIZm5aOFlNTmRXN25VNFk2ZHUyN2RUV3FpVFVjTllCK1RLR3RzRmJuODRkbEFtR04wZHpwcTZtNXlrdgppZWowS29SbjJMWDZmZHArNWRacXFKd1dMK0FsQXBycmY1cjYvNlRBaGNabGwvK1NaMnp3OFRldFVZY1ZFdzdzCit6ZDErelV6TkpMV25WdTByUitFeHNyTzNvdy85T0diTkdRaWk5d1RBRFR6MzlDQ09DQzdUZytIUVowQ3g2NGwKUE5IMjVKSmNYbjYxeXBUa0FwWXRiRUR2V29XWC9yYVJTcmZhclZObU1laFdKb2dSd2VsV1gydlM0cnAwVGdHWApyRGt3NHdNTUl0VmI1WmZoT3paTDV4QVRxZDlUcmRxWUVmZkRDSlNZam91c3VPL3FZSlZad1dTaXBxdXQ5V2c3CmVRSURBUUFCbzBJd1FEQU9CZ05WSFE4QkFmOEVCQU1DQVFZd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlYKSFE0RUZnUVVsbGxrNnl4SEdhTUpMOWtHUHJpV3JDdlY3bGd3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUc0UApIck5TOFpiRmQxTFZnMm5XT1RoTTVrUnZKSkdKZzUwcGlkTm9meTNMWVllVlUxMzZUeDBDZWxiaEZpS2l1SDhOCk9LVFI5cHRVYytXUDlaUlJUQkc0dkxCa3JxSlp3aXUxNUJXVThBT01Pcnhwd05xZlN1OVZFREtaMFRtUVVsWkEKVGxRdEczYk1sVFNpUkNZZXk0NjFQYVlpOE0vNUF1QjJqUDg2N09oUUhTaFdxN3RQUnJXSGFQZE1tekpKODBzUgpTRDNrRlYyUm5aemN5bGEzTFU1cWZaQUhTb20vL0tMb21oK0VlR2N4YWRVRlVwRUl4cDFVN3Z4YnRtRzByT2pKCitjNlJiWExZc2ZWRVNDOVEyUk10MTBUWCtYK1kwSGxzWHdlV0RiNXZOLzIwTlorTGtJR3E4cmNELytBZHhQd0YKcVI4R1hNSUY5TFhpdXk4ZWNjRT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l">https://10.1.0.32:6443,https://10.1.0.33:6443</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xx-prod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">contexts</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">preferences</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">users</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span></span></span></code></pre></div><h4 id="464-设置用户凭据">4.6.4 设置用户凭据</h4>
<div class="highlight" id="id-24"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp *.pem /etc/kubernetes/ssl/
</span></span><span class="line"><span class="cl">kubectl config set-credentials xinn-user2 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--client-certificate<span class="o">=</span>/etc/kubernetes/ssl/xinn-user2.pem <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--client-key<span class="o">=</span>/etc/kubernetes/ssl/xinn-user2-key.pem <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--embed-certs<span class="o">=</span><span class="nb">true</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--kubeconfig<span class="o">=</span>xinn-user2.kubeconfig</span></span></code></pre></div><div class="highlight" id="id-25"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl config set-credentials xinn-user2: 指定要设置的用户凭据名称为 xinn-user2。
</span></span><span class="line"><span class="cl">--client-certificate<span class="o">=</span>/etc/kubernetes/ssl/xinn-user2.pem: 指定用户的客户端证书的路径。
</span></span><span class="line"><span class="cl">--client-key<span class="o">=</span>/etc/kubernetes/ssl/xinn-user2-key.pem: 指定用户的客户端密钥的路径。
</span></span><span class="line"><span class="cl">--embed-certs<span class="o">=</span>true: 将证书和密钥嵌入到 kubeconfig 文件中，以便在不需要外部文件的情况下进行访问。
</span></span><span class="line"><span class="cl">--kubeconfig<span class="o">=</span>xinn-user2.kubeconfig: 指定将配置保存到名为 xinn-user2.kubeconfig 的 kubeconfig 文件中。</span></span></code></pre></div><div class="highlight" id="id-26"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">root@k8s-made-01-32:~# cat xinn-user2.kubeconfig</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">clusters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">cluster</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">certificate-authority-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURtakNDQW9LZ0F3SUJBZ0lVTnhMZWE2QTZvVC9HL0dnR24rZ01uRDJjR2VBd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pERUxNQWtHQTFVRUJoTUNRMDR4RVRBUEJnTlZCQWdUQ0VoaGJtZGFhRzkxTVFzd0NRWURWUVFIRXdKWQpVekVNTUFvR0ExVUVDaE1EYXpoek1ROHdEUVlEVlFRTEV3WlRlWE4wWlcweEZqQVVCZ05WQkFNVERXdDFZbVZ5CmJtVjBaWE10WTJFd0lCY05Nak13TmpFME1EazBPVEF3V2hnUE1qRXlNekExTWpFd09UUTVNREJhTUdReEN6QUoKQmdOVkJBWVRBa05PTVJFd0R3WURWUVFJRXdoSVlXNW5XbWh2ZFRFTE1Ba0dBMVVFQnhNQ1dGTXhEREFLQmdOVgpCQW9UQTJzNGN6RVBNQTBHQTFVRUN4TUdVM2x6ZEdWdE1SWXdGQVlEVlFRREV3MXJkV0psY201bGRHVnpMV05oCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBckNRN2VwV2RqTCtEMXNVY0FacXgKdjcrRGxIZm5aOFlNTmRXN25VNFk2ZHUyN2RUV3FpVFVjTllCK1RLR3RzRmJuODRkbEFtR04wZHpwcTZtNXlrdgppZWowS29SbjJMWDZmZHArNWRacXFKd1dMK0FsQXBycmY1cjYvNlRBaGNabGwvK1NaMnp3OFRldFVZY1ZFdzdzCit6ZDErelV6TkpMV25WdTByUitFeHNyTzNvdy85T0diTkdRaWk5d1RBRFR6MzlDQ09DQzdUZytIUVowQ3g2NGwKUE5IMjVKSmNYbjYxeXBUa0FwWXRiRUR2V29XWC9yYVJTcmZhclZObU1laFdKb2dSd2VsV1gydlM0cnAwVGdHWApyRGt3NHdNTUl0VmI1WmZoT3paTDV4QVRxZDlUcmRxWUVmZkRDSlNZam91c3VPL3FZSlZad1dTaXBxdXQ5V2c3CmVRSURBUUFCbzBJd1FEQU9CZ05WSFE4QkFmOEVCQU1DQVFZd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlYKSFE0RUZnUVVsbGxrNnl4SEdhTUpMOWtHUHJpV3JDdlY3bGd3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUc0UApIck5TOFpiRmQxTFZnMm5XT1RoTTVrUnZKSkdKZzUwcGlkTm9meTNMWVllVlUxMzZUeDBDZWxiaEZpS2l1SDhOCk9LVFI5cHRVYytXUDlaUlJUQkc0dkxCa3JxSlp3aXUxNUJXVThBT01Pcnhwd05xZlN1OVZFREtaMFRtUVVsWkEKVGxRdEczYk1sVFNpUkNZZXk0NjFQYVlpOE0vNUF1QjJqUDg2N09oUUhTaFdxN3RQUnJXSGFQZE1tekpKODBzUgpTRDNrRlYyUm5aemN5bGEzTFU1cWZaQUhTb20vL0tMb21oK0VlR2N4YWRVRlVwRUl4cDFVN3Z4YnRtRzByT2pKCitjNlJiWExZc2ZWRVNDOVEyUk10MTBUWCtYK1kwSGxzWHdlV0RiNXZOLzIwTlorTGtJR3E4cmNELytBZHhQd0YKcVI4R1hNSUY5TFhpdXk4ZWNjRT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l">https://10.1.0.32:6443,https://10.1.0.33:6443</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xx-prod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">contexts</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">preferences</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">users</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">client-certificate-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQyRENDQXNDZ0F3SUJBZ0lVSHFCcXVUdzI2WWhSMUg2WkxtT2ZRbHBTbEhrd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pERUxNQWtHQTFVRUJoTUNRMDR4RVRBUEJnTlZCQWdUQ0VoaGJtZGFhRzkxTVFzd0NRWURWUVFIRXdKWQpVekVNTUFvR0ExVUVDaE1EYXpoek1ROHdEUVlEVlFRTEV3WlRlWE4wWlcweEZqQVVCZ05WQkFNVERXdDFZbVZ5CmJtVjBaWE10WTJFd0lCY05NalF3TVRBME1Ea3hNVEF3V2hnUE1qQTNNekV5TWpJd09URXhNREJhTUdVeEN6QUoKQmdOVkJBWVRBa05PTVJBd0RnWURWUVFJRXdkQ1pXbEthVzVuTVJBd0RnWURWUVFIRXdkQ1pXbEthVzVuTVF3dwpDZ1lEVlFRS0V3TnJPSE14RHpBTkJnTlZCQXNUQmxONWMzUmxiVEVUTUJFR0ExVUVBeE1LZUdsdWJpMTFjMlZ5Ck1qQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQU1vbnNzRDhtYnRDZWFXMHhaVC8KaGRZUEtlQktwMG9IQ0hLcFRCUndNaVRGdkFkMnErWVJUdlNMOUE4WDM4b25DSnlmRlRDeFZUNUhycGNUTkF4TwpDc1JiYW1PR0psSUp2YkxYWm9VdUZGUHRWd3lzWWRiMUdYblQ1TGxPWkVlcDNiYlN0YmllTVlORkJ3TjRuZERsCnpWMHdGQ2Z5OEFKUTN0cGtYRGprTzgvUlJoM2NVa1FWejZDdStibWU0U1J3VWFDdkk0ZmZwQkRqM1FoWGw2UTcKVER6dzBMN2JNM01BMWlqQUtOeXkycjBEc293UHo4aWUrTUJqR1JRcGtzMTI4RzdlN05CNjYyYlF3ZlRIaGplTwowZFFRVloxTVMzQ2dRSlBLM3ZXbzVvSS9FM1p4NzdVa2dTWWxzaVdwUkxCMHhKNFdYNEsyVlN6ZE9nQ0drSHAxCmRCc0NBd0VBQWFOL01IMHdEZ1lEVlIwUEFRSC9CQVFEQWdXZ01CMEdBMVVkSlFRV01CUUdDQ3NHQVFVRkJ3TUIKQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RUFqQUFNQjBHQTFVZERnUVdCQlJ6NVJUZGZGOGZqNGNENXFYMQppbmdOSVpxSWV6QWZCZ05WSFNNRUdEQVdnQlNXV1dUckxFY1pvd2t2MlFZK3VKYXNLOVh1V0RBTkJna3Foa2lHCjl3MEJBUXNGQUFPQ0FRRUFlVTZTVDN3VCtrb1IzWm85N05welhZbURlVzJhTEdZYXFyb05iSmYvVVM1czhQLysKK1JFdG54cDRhaFNUVGplSnE1ZUkzUzZDMUtqVVhMQUpaOUVvK1FsdlkxVWtLNE52MW1mRmVwM0tLNm1ZVHltRwpmaDBKa25iVGxuSERiWEpWNk9LYWoveGFpWlE2akxNRWdDMVlSREJQbXlLVzc3cEhZanFyRUtINUtpWFc5b0hyCkVsWDNWL0Z4R3hOdy9oV1QvZmpPZWFLRE9xdEZIdzZBRlNEUFNab1ZzTnN6dmJJRU1WMVRUQzVBUTNXSFFNY3UKRHhQYVBmZTd0dmUvVVp0M1dEZngxRUNHSDlobFhIU2J0MUYwT2p4MkdvVy8yTjZadEptb2s3UnBVSDRHMVBpbAowNGFVZ3ZuNUtlTW4rdG8rY29yUGwrc2dDTnJhYTFWcnF0cjEvZz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">client-key-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeWlleXdQeVp1MEo1cGJURmxQK0YxZzhwNEVxblNnY0ljcWxNRkhBeUpNVzhCM2FyCjVoRk85SXYwRHhmZnlpY0luSjhWTUxGVlBrZXVseE0wREU0S3hGdHFZNFltVWdtOXN0ZG1oUzRVVSsxWERLeGgKMXZVWmVkUGt1VTVrUjZuZHR0SzF1SjR4ZzBVSEEzaWQwT1hOWFRBVUovTHdBbERlMm1SY09PUTd6OUZHSGR4UwpSQlhQb0s3NXVaN2hKSEJSb0s4amg5K2tFT1BkQ0ZlWHBEdE1QUERRdnRzemN3RFdLTUFvM0xMYXZRT3lqQS9QCnlKNzR3R01aRkNtU3pYYndidDdzMEhyclp0REI5TWVHTjQ3UjFCQlZuVXhMY0tCQWs4cmU5YWptZ2o4VGRuSHYKdFNTQkppV3lKYWxFc0hURW5oWmZnclpWTE4wNkFJYVFlblYwR3dJREFRQUJBb0lCQUdmVy9Ic2xSZEpxMHhITApTYksvam4vbVNoeHNQSUpLR296TGFja1YyS3dLNWdydmFsMURoc3NYR01hbi9NeGFRSkl6SlM5ZDUrdVY1cGl6CnhJaU5qZnBPK3Rja2tZcVNkbDduUmtJaTZVNHpIQVBtaUZ0aWl6T0pKSFFMVUhkL1NlUWZXRGo5Q1hIa2d6WEYKUDB1T3YyNmV3N3ZCam9laUF0Y3J0ak9EQ1RZMTNraklRUGd4UVhlU1ZsUkl5bzI5K1FQdVNOa1hmK0VweUY3awp1UU1iUzZ3Y2tZNEIweGYwc0xJMzhGY3BJNnpaVncrQVd0U0dHbHNJNUF5VFZHbFNCTEh5ZFFTd3RMSnBxa1YyCjlDbFNQTklwbE56T3d1aFkyai9BZHVNZzlJVW01ajBNQzNyQTNwV2Fua0RDMWNnYVp0MHRVM2tSeHNtOUtVS2wKcW9BZzFBRUNnWUVBektGTkxPOUZrWENld0JmdXJlRzlXclltRGtTMGRuK21GWUI5MnFhdUlxYjNzNnNBTm9DYwowR2JSdTlDb0RCNm9Cdmg0VncrRnUwN0xxb2FSTE84ZzZRODFmbi82ei9HbCtDMG5iQndFUDdvbTIybmN4UHZECkpqNjUzZXdJblZxUUNmT01RVS9RcGR2cUIyNXNFUjZKQ2dJM2dzMUNwd1pWd3poUllMb3l2bFVDZ1lFQS9PZFcKbllwMFRteS8wTEw0K0RNUFluWHF6NXY4d0pxb2lTc0pRSlRDR1hmNmwyWnlHUHFhOC9EVTJ1eXpQZWRpZEVVTwpZNkx5YjFJczJtOThaOWM2NlNzcW1EeSs4Tmt4M3RYNU54Qk1lSVEwbmlya0Z4SlhQaWtQblh0VXF5MVF4bytuCnpuYzl3MFZxOStRLzh6NVVmMHZtUjMweTg0bkl4NU1MZVhEWCtLOENnWUFXR05FQnFqRGovTHBYMmYyL0x5SkkKZW1Udm80R3RUaWw4SnV6d1FKR0xVbVpyTTJzSmQ2ZjNaVEwreWhCcmhwLzBhTDV1QUZJYm9PMmpVM2EzMkhiQQpWQkVkd09vdnJGT1UwaU53ckRIVlE5L1FUOFUwVEUrTmdMYUhmV2FNdjJ2UWQwbE5BRFp5d3FXcCtjV1hyNmx5CnVEeVFWbVA5TDFUeGlOSlkxS0tJSlFLQmdRQ0dmZkFONzZkU1hYclVYWmtSUlBZVmdtZlE2RDlObmZHcW9IeFgKSDhUcERtanhRc1hDaXVNRWZ6cHpBaFdBQWlEVmZEUGV3TFQwaGxyYi94WEZreXY4Kzd1M0lmYlkxbWd5L005LwpmT2R0MzhDcnJGdUgrWFR6MVpvOFFXNFJhaFBleEY2VTZjeXFuNnYzRUNjQ0VFK1hNcUhQdXNEeHlvQS93ZThFCk1nSm9lUUtCZ1FDT1B4U3RlZ0owWGlqWmRVeTBoajhWaVlqY2ZScExES1Z2Y1lnMTREYTZXdGRTM2tkUXJLZUoKcURaM3lqc3JPa0tUckp2eHd2cFVIRFhCRmtodU9KbitXNHc0RlNWeG9kYkd5YTlNSkwvbG12dHVZVjJQd2tyOApUK2tUTUF3SjlUZklleWF1NGV2MEdTMzAwS2VXblJmc2Y0K1dTdWpxMkc2Yzgxb1BSWnluTlE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=</span></span></span></code></pre></div><h4 id="465-设置上下文参数多集群使用上下文区分">4.6.5 设置上下文参数(多集群使用上下文区分)</h4>
<p><a href="https://kubernetes.io/zh/docs/concepts/configuration/organize-cluster-access-kubeconfig/"target="_blank" rel="external nofollow noopener noreferrer">https://kubernetes.io/zh/docs/concepts/configuration/organize-cluster-access-kubeconfig/</a></p>
<div class="highlight" id="id-27"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl config set-context xx-prod <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--cluster<span class="o">=</span>xx-prod <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--user<span class="o">=</span>xinn-user2 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--namespace<span class="o">=</span>xinn <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--kubeconfig<span class="o">=</span>xinn-user2.kubeconfig</span></span></code></pre></div><div class="highlight" id="id-28"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">在 Kubernetes 中，上下文（Context）是指向集群、用户和命名空间的指针，允许用户在不同的环境（集群）和身份（用户）之间进行切换。
</span></span><span class="line"><span class="cl">kubectl config set-context xx-prod: 指定要设置的上下文名称为 xx-prod。
</span></span><span class="line"><span class="cl">--cluster<span class="o">=</span>xx-prod: 指定该上下文所使用的集群名称为 xx-prod，这个集群名称对应之前设置的集群名称。
</span></span><span class="line"><span class="cl">--user<span class="o">=</span>xinn-user2: 指定该上下文所使用的用户名称为 xinn-user2，这个用户名称对应之前设置的用户凭据。
</span></span><span class="line"><span class="cl">--namespace<span class="o">=</span>xinn: 指定该上下文所使用的命名空间为 xinn，这将成为该上下文的默认命名空间。
</span></span><span class="line"><span class="cl">--kubeconfig<span class="o">=</span>xinn-user2.kubeconfig: 指定将配置保存到名为 xinn-user2.kubeconfig 的 kubeconfig 文件中。</span></span></code></pre></div><div class="highlight" id="id-29"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">root@k8s-made-01-32:~# cat xinn-user2.kubeconfig</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">clusters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">cluster</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">certificate-authority-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURtakNDQW9LZ0F3SUJBZ0lVTnhMZWE2QTZvVC9HL0dnR24rZ01uRDJjR2VBd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pERUxNQWtHQTFVRUJoTUNRMDR4RVRBUEJnTlZCQWdUQ0VoaGJtZGFhRzkxTVFzd0NRWURWUVFIRXdKWQpVekVNTUFvR0ExVUVDaE1EYXpoek1ROHdEUVlEVlFRTEV3WlRlWE4wWlcweEZqQVVCZ05WQkFNVERXdDFZbVZ5CmJtVjBaWE10WTJFd0lCY05Nak13TmpFME1EazBPVEF3V2hnUE1qRXlNekExTWpFd09UUTVNREJhTUdReEN6QUoKQmdOVkJBWVRBa05PTVJFd0R3WURWUVFJRXdoSVlXNW5XbWh2ZFRFTE1Ba0dBMVVFQnhNQ1dGTXhEREFLQmdOVgpCQW9UQTJzNGN6RVBNQTBHQTFVRUN4TUdVM2x6ZEdWdE1SWXdGQVlEVlFRREV3MXJkV0psY201bGRHVnpMV05oCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBckNRN2VwV2RqTCtEMXNVY0FacXgKdjcrRGxIZm5aOFlNTmRXN25VNFk2ZHUyN2RUV3FpVFVjTllCK1RLR3RzRmJuODRkbEFtR04wZHpwcTZtNXlrdgppZWowS29SbjJMWDZmZHArNWRacXFKd1dMK0FsQXBycmY1cjYvNlRBaGNabGwvK1NaMnp3OFRldFVZY1ZFdzdzCit6ZDErelV6TkpMV25WdTByUitFeHNyTzNvdy85T0diTkdRaWk5d1RBRFR6MzlDQ09DQzdUZytIUVowQ3g2NGwKUE5IMjVKSmNYbjYxeXBUa0FwWXRiRUR2V29XWC9yYVJTcmZhclZObU1laFdKb2dSd2VsV1gydlM0cnAwVGdHWApyRGt3NHdNTUl0VmI1WmZoT3paTDV4QVRxZDlUcmRxWUVmZkRDSlNZam91c3VPL3FZSlZad1dTaXBxdXQ5V2c3CmVRSURBUUFCbzBJd1FEQU9CZ05WSFE4QkFmOEVCQU1DQVFZd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlYKSFE0RUZnUVVsbGxrNnl4SEdhTUpMOWtHUHJpV3JDdlY3bGd3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUc0UApIck5TOFpiRmQxTFZnMm5XT1RoTTVrUnZKSkdKZzUwcGlkTm9meTNMWVllVlUxMzZUeDBDZWxiaEZpS2l1SDhOCk9LVFI5cHRVYytXUDlaUlJUQkc0dkxCa3JxSlp3aXUxNUJXVThBT01Pcnhwd05xZlN1OVZFREtaMFRtUVVsWkEKVGxRdEczYk1sVFNpUkNZZXk0NjFQYVlpOE0vNUF1QjJqUDg2N09oUUhTaFdxN3RQUnJXSGFQZE1tekpKODBzUgpTRDNrRlYyUm5aemN5bGEzTFU1cWZaQUhTb20vL0tMb21oK0VlR2N4YWRVRlVwRUl4cDFVN3Z4YnRtRzByT2pKCitjNlJiWExZc2ZWRVNDOVEyUk10MTBUWCtYK1kwSGxzWHdlV0RiNXZOLzIwTlorTGtJR3E4cmNELytBZHhQd0YKcVI4R1hNSUY5TFhpdXk4ZWNjRT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l">https://10.1.0.32:6443,https://10.1.0.33:6443</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xx-prod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">contexts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">context</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l">xx-prod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">xinn</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xx-prod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">preferences</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">users</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">client-certificate-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQwekNDQXJ1Z0F3SUJBZ0lVZHdCM0NvRGJpL2JUMFkyc1B6SVhweVFoY1prd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pERUxNQWtHQTFVRUJoTUNRMDR4RVRBUEJnTlZCQWdUQ0VoaGJtZGFhRzkxTVFzd0NRWURWUVFIRXdKWQpVekVNTUFvR0ExVUVDaE1EYXpoek1ROHdEUVlEVlFRTEV3WlRlWE4wWlcweEZqQVVCZ05WQkFNVERXdDFZbVZ5CmJtVjBaWE10WTJFd0lCY05NalF3TVRBME1EZ3pNekF3V2hnUE1qQTNNekV5TWpJd09ETXpNREJhTUdBeEN6QUoKQmdOVkJBWVRBa05PTVJBd0RnWURWUVFJRXdkQ1pXbEthVzVuTVJBd0RnWURWUVFIRXdkQ1pXbEthVzVuTVF3dwpDZ1lEVlFRS0V3TnJPSE14RHpBTkJnTlZCQXNUQmxONWMzUmxiVEVPTUF3R0ExVUVBeE1GUTJocGJtRXdnZ0VpCk1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRREhPRHZ3ZHJvWExtYXNySSt3cmdXOWJjNzIKY09PQWR0dFpTMGFjNE12NVE4MTR4cWlkS3pEdXpDVDFiSlBZL3E5emdkalo3OWhpNUZmcXJ5cWN1alAzdWZPNApGeE01MVFKbzJIdmVNQ1luZ0NWdDlKd1dqR3prb1M3alliNlowY0kvRVdQWExpMzYwTWFrb2RBdGNXdTdRNlJHCmNGSkh5OXJtY0tOaFY5MTRuTkg3UWN4TllxcXdXT0M2SVVlL3J6aG9Mbmw3d1hvZXlwWjgvNjdRUnhzTHVNaG4KV2YrZ1V3azR1eGpScmx3V1ZvSVVEeGdvVzZjRlRZNEpHcFFjQS9pMUVtTGEzMXpLRWxxbG1vVDV3QkRTbzl2SQp1MEc5OGtkZk9hR1BWS1VZdllZZ3RuelFadjU0SkFaZXl3MlB3b1JDaEszby9Lbks1UktDQWhBRHRDb2JBZ01CCkFBR2pmekI5TUE0R0ExVWREd0VCL3dRRUF3SUZvREFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUIKQlFVSEF3SXdEQVlEVlIwVEFRSC9CQUl3QURBZEJnTlZIUTRFRmdRVXpobmdUeVgweXUyVnkxd1dPNm1oUy9xUQpyV013SHdZRFZSMGpCQmd3Rm9BVWxsbGs2eXhIR2FNSkw5a0dQcmlXckN2VjdsZ3dEUVlKS29aSWh2Y05BUUVMCkJRQURnZ0VCQUlkYmNubnE1TVRTdkpSbHdSVDhVdmFkVDROZGdvWUhuenNTd0tqQjYxWG8wOE53WFhDSjVaSlQKaTF2bm1zaW10dTZGYThZTDF4b01hOGJwaFVUcnlqQnNoS09zNWNzWGxuOTlDcVcydm41THE0WVRPNVNycnJyZgpycjdiaCtsWWFqLzczVTkzaUpxRENKRy9YVExuUlhldjRvMENqQTVsa0R2KzdXQkVqMTI3b3JKRjBJcVdxaW9xCmtpU3NHcGJPOHI5bGdLRXhuRmtuYUxDUlBENlNrTXlwakVnRnBDSXdaU1hCL1JqQmZSc0FjalVHMmZrYk1mN08KM1ozaGY4TzBWbFowQUxGMzBIMHlCTEhueERSWVhmZVBEVXNUVi9SSzhYMnpwQ2ljWXEyT1AyOHZYdUgrTU5Ndgp2NHM0Y1BhMGlNQ2lxaVlMblRwUlN1VkVWYUttQTJvPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">client-key-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeHpnNzhIYTZGeTVtckt5UHNLNEZ2VzNPOW5EamdIYmJXVXRHbk9ETCtVUE5lTWFvCm5Tc3c3c3drOVd5VDJQNnZjNEhZMmUvWVl1Ulg2cThxbkxvejk3bnp1QmNUT2RVQ2FOaDczakFtSjRBbGJmU2MKRm94czVLRXU0MkcrbWRIQ1B4RmoxeTR0K3RER3BLSFFMWEZydTBPa1JuQlNSOHZhNW5DallWZmRlSnpSKzBITQpUV0txc0ZqZ3VpRkh2Njg0YUM1NWU4RjZIc3FXZlArdTBFY2JDN2pJWjFuL29GTUpPTHNZMGE1Y0ZsYUNGQThZCktGdW5CVTJPQ1JxVUhBUDR0UkppMnQ5Y3loSmFwWnFFK2NBUTBxUGJ5THRCdmZKSFh6bWhqMVNsR0wyR0lMWjgKMEdiK2VDUUdYc3NOajhLRVFvU3Q2UHlweXVVU2dnSVFBN1FxR3dJREFRQUJBb0lCQVFDTHlSQjl4TUVFZlFGOApUY1N4SXhwUjlaZlA0aHd2eXJaVXJIWUtvODFieE5DSzIxSDZuaERDcmltTXI3ZjUvWkxjaUpMQk1RTHpPT2ZiCmV6ZDZLMGxGbkl1L2N5bUJYYzVJQlFhOU82bTU4N2ZQdEdCRmpoam1QNWJuNDNEYSs0ekJ0aEVKTHBVQ3RiVjgKVlRIK2dPUW56T21hcHp1RXR5eU1ueUowcmpOdmFkUGdrbnNVS1o5b3crZHgxWVlmOVJYSTl3eCs3S2Y0bXk3TQplODkrUWkyNDZXbUJ1RVlPanBGcWV2ajhrQUVXMDhtK1JPVVk5SXllSllETS8raTJ6Vi9lOHhHN2UrT2tHTXl0CnNXaUVBMndrZ1JQRlFMVWs0OU9OZGkzQWp3QTJXOEdockJtclBGb1FZMVp2amtrOTZuSzJlMjMrZUJGSTJBQ0UKdjJ6VkdkNVpBb0dCQVBhc2x1ZnREbGpTVUdNb2FWTy9rbWdtcjFiV0FENy80c2NXU1lMWENlNDRpRlVNTHIzbgowM0hXK1Bma0lPdndTSCtsRVVnb1dqUkdsWjIzdXB5VVhFRXZrZHhyTlJIOFhQRndZclVmVWgxT0p5SXlFcnFPCjE2YjNVKzhuejN0YVlTQmJqd2Y0N1praDl1L2FQTzBCTUx0ZDJrVHZpRFhsMmdRdmFhejlGakoxQW9HQkFNN0EKWEc2cDBrbVUxM1hoOGZ2dVI3bkNXaUpmOWNkYnZ5c25RVk5RdjcwamZqS01zRjhNZkJocmUxUi9lY0ZIS0RBbQpVN1d6d3ZTQXlraEw1SmoxY1MydzYyK3JaV0NRcml6UnpTeWIyYy9IRCtlV1NjazlOSm1TMEtRa29qYU9rWEMyCmFKYTdYeWdnNkpTK3l5QlQyYUtLMWRHeVNvbzJvemtqM0Q3bmJUaFBBb0dBTE04alJwUXdkQUFZYkRyT0QxR1EKaGV6cEV3d2kxVTdrWWlmeFNKeEppSVdxZGxDVk9SZ2d0K0JHTDdtNEpVUHIxNHdqdklqZ0Fma0VlcmNDWmlrcApMUW80SStNeHE4ZTlGbnJFNDRRQ0JhTEp4eE56aFlJbk9JUmJNZWw0Ymo3M3Y4b0NESCt5b1l1aThPVWpCaWFlCk5Kc1M2RXplNEhPVmpBY1Uya0RMUkhVQ2dZQm1CSUVYa2ZCVG9vQVdpT0R3b1FqL1hpay9vUDRUMnUrZmlZVXcKYVQzVFJEbzNFempNRGNzRitiTW5aS2RkZVpFWkFUQjVEalI2bFRvN0prZXNPaUFZblozdXdqSUp6aHBEdjFwdwpVbzdOZWJvZFdna2FwWHJZOUpyREE5aU85eFpJK1pqdUY1TENxRXBiYXpHcngvUXh3alB6ZnZoTTd0em5pd3hZCmRiVnMvUUtCZ1FDbmZrZ2MrWUMwZktEUmk3TjJ6Q2xLL3ZHRzlMdTRQV3QxWVJZQUlEbU9GZTN2b01aUVpSQ3oKUGlFdmNQeFVEVC94bUR6dXo5aER1YmVJN1lGYUkyZ0JCUUhILzFJVWhkVlh6WlNYRXIzOEJobTk4RHBYT2UwdgplR0tPUko0dEV5d2hkcUNqSzBqYmxFMmNkK1JaVmZpY09SNXNIZ0ZPNFpzQ2J6UEpxWmMydFE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=</span></span></span></code></pre></div><h4 id="466--设置默认上下文">4.6.6  设置默认上下文</h4>
<div class="highlight" id="id-30"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl config use-context xx-prod --kubeconfig<span class="o">=</span>xinn-user2.kubeconfig</span></span></code></pre></div><div class="highlight" id="id-31"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl config use-context xx-prod: <span class="c1">#将名为 xx-prod 的上下文设置为当前默认上下文。这个上下文应该是之前在 kubeconfig 文件中配置的一个上下文。</span>
</span></span><span class="line"><span class="cl">--kubeconfig<span class="o">=</span>xinn-user2.kubeconfig: <span class="c1">#指定了要操作的 kubeconfig 文件，这个命令将在这个文件中设置默认上下文。</span></span></span></code></pre></div><h4 id="467-获取账号token">4.6.7 获取账号token</h4>
<div class="highlight" id="id-32"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@k8s-made-01-32:~# kubectl describe secrets -n xinn xinn-user2
</span></span><span class="line"><span class="cl">Name:         xinn-user2
</span></span><span class="line"><span class="cl">Namespace:    xinn
</span></span><span class="line"><span class="cl">Labels:       &lt;none&gt;
</span></span><span class="line"><span class="cl">Annotations:  kubernetes.io/service-account.name: xinn-user2
</span></span><span class="line"><span class="cl">              kubernetes.io/service-account.uid: bd3c6967-56d0-4c18-9386-83f2492115a0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Type:  kubernetes.io/service-account-token
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">Data</span>
</span></span><span class="line"><span class="cl"><span class="o">====</span>
</span></span><span class="line"><span class="cl">ca.crt:     <span class="m">1310</span> bytes
</span></span><span class="line"><span class="cl">namespace:  <span class="m">4</span> bytes
</span></span><span class="line"><span class="cl">token:      eyJhbGciOiJSUzI1NiIsImtpZCI6Il82SWdMUWRGbnlHeGEtQnpReDVvUE9PWW9yWXY4cmg0NWdsT2ZiNTZiY0UifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJ4aW5uIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6Inhpbm4tdXNlcjIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoieGlubi11c2VyMiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6ImJkM2M2OTY3LTU2ZDAtNGMxOC05Mzg2LTgzZjI0OTIxMTVhMCIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDp4aW5uOnhpbm4tdXNlcjIifQ.A5c7l704dYJ10ftkqSEYjhPyO5AX7b-qKFVbAO4bk3xp2z6idfNo8suvZ9JiNhXzmMhIAa99aURbuUPeSZFHuIWBgUiU4lEAGlIfZJdgGbQan0qCxSfJpr9wKfPU3dgKo7PRnXhRyDtBwAFjrarlJu3CmnpJ_Ntz489s_ZIz1yJ4lTmcjqT9zElMj0Hxczm9zqxrt0BWYjQQIm4UgLOjEf2CkvJ-Ln8ucmRZLdZ4Hrvc9h5Sy1GvDIYJUKVCl4y_dnxD26wePmoJdn-WCA-GEYHE-BHsAeN_YdHDi1056NsUk05HZJ2EQNY57_IQctpffUxaQfKK-WRayyHiv1UE2g</span></span></code></pre></div><h4 id="468-将token写入用户kube-config文件">4.6.8 将token写入用户kube-config文件</h4>
<div class="highlight" id="id-33"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">client-certificate-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQwekNDQXJ1Z0F3SUJBZ0lVZHdCM0NvRGJpL2JUMFkyc1B6SVhweVFoY1prd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pERUxNQWtHQTFVRUJoTUNRMDR4RVRBUEJnTlZCQWdUQ0VoaGJtZGFhRzkxTVFzd0NRWURWUVFIRXdKWQpVekVNTUFvR0ExVUVDaE1EYXpoek1ROHdEUVlEVlFRTEV3WlRlWE4wWlcweEZqQVVCZ05WQkFNVERXdDFZbVZ5CmJtVjBaWE10WTJFd0lCY05NalF3TVRBME1EZ3pNekF3V2hnUE1qQTNNekV5TWpJd09ETXpNREJhTUdBeEN6QUoKQmdOVkJBWVRBa05PTVJBd0RnWURWUVFJRXdkQ1pXbEthVzVuTVJBd0RnWURWUVFIRXdkQ1pXbEthVzVuTVF3dwpDZ1lEVlFRS0V3TnJPSE14RHpBTkJnTlZCQXNUQmxONWMzUmxiVEVPTUF3R0ExVUVBeE1GUTJocGJtRXdnZ0VpCk1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRREhPRHZ3ZHJvWExtYXNySSt3cmdXOWJjNzIKY09PQWR0dFpTMGFjNE12NVE4MTR4cWlkS3pEdXpDVDFiSlBZL3E5emdkalo3OWhpNUZmcXJ5cWN1alAzdWZPNApGeE01MVFKbzJIdmVNQ1luZ0NWdDlKd1dqR3prb1M3alliNlowY0kvRVdQWExpMzYwTWFrb2RBdGNXdTdRNlJHCmNGSkh5OXJtY0tOaFY5MTRuTkg3UWN4TllxcXdXT0M2SVVlL3J6aG9Mbmw3d1hvZXlwWjgvNjdRUnhzTHVNaG4KV2YrZ1V3azR1eGpScmx3V1ZvSVVEeGdvVzZjRlRZNEpHcFFjQS9pMUVtTGEzMXpLRWxxbG1vVDV3QkRTbzl2SQp1MEc5OGtkZk9hR1BWS1VZdllZZ3RuelFadjU0SkFaZXl3MlB3b1JDaEszby9Lbks1UktDQWhBRHRDb2JBZ01CCkFBR2pmekI5TUE0R0ExVWREd0VCL3dRRUF3SUZvREFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUIKQlFVSEF3SXdEQVlEVlIwVEFRSC9CQUl3QURBZEJnTlZIUTRFRmdRVXpobmdUeVgweXUyVnkxd1dPNm1oUy9xUQpyV013SHdZRFZSMGpCQmd3Rm9BVWxsbGs2eXhIR2FNSkw5a0dQcmlXckN2VjdsZ3dEUVlKS29aSWh2Y05BUUVMCkJRQURnZ0VCQUlkYmNubnE1TVRTdkpSbHdSVDhVdmFkVDROZGdvWUhuenNTd0tqQjYxWG8wOE53WFhDSjVaSlQKaTF2bm1zaW10dTZGYThZTDF4b01hOGJwaFVUcnlqQnNoS09zNWNzWGxuOTlDcVcydm41THE0WVRPNVNycnJyZgpycjdiaCtsWWFqLzczVTkzaUpxRENKRy9YVExuUlhldjRvMENqQTVsa0R2KzdXQkVqMTI3b3JKRjBJcVdxaW9xCmtpU3NHcGJPOHI5bGdLRXhuRmtuYUxDUlBENlNrTXlwakVnRnBDSXdaU1hCL1JqQmZSc0FjalVHMmZrYk1mN08KM1ozaGY4TzBWbFowQUxGMzBIMHlCTEhueERSWVhmZVBEVXNUVi9SSzhYMnpwQ2ljWXEyT1AyOHZYdUgrTU5Ndgp2NHM0Y1BhMGlNQ2lxaVlMblRwUlN1VkVWYUttQTJvPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">client-key-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeHpnNzhIYTZGeTVtckt5UHNLNEZ2VzNPOW5EamdIYmJXVXRHbk9ETCtVUE5lTWFvCm5Tc3c3c3drOVd5VDJQNnZjNEhZMmUvWVl1Ulg2cThxbkxvejk3bnp1QmNUT2RVQ2FOaDczakFtSjRBbGJmU2MKRm94czVLRXU0MkcrbWRIQ1B4RmoxeTR0K3RER3BLSFFMWEZydTBPa1JuQlNSOHZhNW5DallWZmRlSnpSKzBITQpUV0txc0ZqZ3VpRkh2Njg0YUM1NWU4RjZIc3FXZlArdTBFY2JDN2pJWjFuL29GTUpPTHNZMGE1Y0ZsYUNGQThZCktGdW5CVTJPQ1JxVUhBUDR0UkppMnQ5Y3loSmFwWnFFK2NBUTBxUGJ5THRCdmZKSFh6bWhqMVNsR0wyR0lMWjgKMEdiK2VDUUdYc3NOajhLRVFvU3Q2UHlweXVVU2dnSVFBN1FxR3dJREFRQUJBb0lCQVFDTHlSQjl4TUVFZlFGOApUY1N4SXhwUjlaZlA0aHd2eXJaVXJIWUtvODFieE5DSzIxSDZuaERDcmltTXI3ZjUvWkxjaUpMQk1RTHpPT2ZiCmV6ZDZLMGxGbkl1L2N5bUJYYzVJQlFhOU82bTU4N2ZQdEdCRmpoam1QNWJuNDNEYSs0ekJ0aEVKTHBVQ3RiVjgKVlRIK2dPUW56T21hcHp1RXR5eU1ueUowcmpOdmFkUGdrbnNVS1o5b3crZHgxWVlmOVJYSTl3eCs3S2Y0bXk3TQplODkrUWkyNDZXbUJ1RVlPanBGcWV2ajhrQUVXMDhtK1JPVVk5SXllSllETS8raTJ6Vi9lOHhHN2UrT2tHTXl0CnNXaUVBMndrZ1JQRlFMVWs0OU9OZGkzQWp3QTJXOEdockJtclBGb1FZMVp2amtrOTZuSzJlMjMrZUJGSTJBQ0UKdjJ6VkdkNVpBb0dCQVBhc2x1ZnREbGpTVUdNb2FWTy9rbWdtcjFiV0FENy80c2NXU1lMWENlNDRpRlVNTHIzbgowM0hXK1Bma0lPdndTSCtsRVVnb1dqUkdsWjIzdXB5VVhFRXZrZHhyTlJIOFhQRndZclVmVWgxT0p5SXlFcnFPCjE2YjNVKzhuejN0YVlTQmJqd2Y0N1praDl1L2FQTzBCTUx0ZDJrVHZpRFhsMmdRdmFhejlGakoxQW9HQkFNN0EKWEc2cDBrbVUxM1hoOGZ2dVI3bkNXaUpmOWNkYnZ5c25RVk5RdjcwamZqS01zRjhNZkJocmUxUi9lY0ZIS0RBbQpVN1d6d3ZTQXlraEw1SmoxY1MydzYyK3JaV0NRcml6UnpTeWIyYy9IRCtlV1NjazlOSm1TMEtRa29qYU9rWEMyCmFKYTdYeWdnNkpTK3l5QlQyYUtLMWRHeVNvbzJvemtqM0Q3bmJUaFBBb0dBTE04alJwUXdkQUFZYkRyT0QxR1EKaGV6cEV3d2kxVTdrWWlmeFNKeEppSVdxZGxDVk9SZ2d0K0JHTDdtNEpVUHIxNHdqdklqZ0Fma0VlcmNDWmlrcApMUW80SStNeHE4ZTlGbnJFNDRRQ0JhTEp4eE56aFlJbk9JUmJNZWw0Ymo3M3Y4b0NESCt5b1l1aThPVWpCaWFlCk5Kc1M2RXplNEhPVmpBY1Uya0RMUkhVQ2dZQm1CSUVYa2ZCVG9vQVdpT0R3b1FqL1hpay9vUDRUMnUrZmlZVXcKYVQzVFJEbzNFempNRGNzRitiTW5aS2RkZVpFWkFUQjVEalI2bFRvN0prZXNPaUFZblozdXdqSUp6aHBEdjFwdwpVbzdOZWJvZFdna2FwWHJZOUpyREE5aU85eFpJK1pqdUY1TENxRXBiYXpHcngvUXh3alB6ZnZoTTd0em5pd3hZCmRiVnMvUUtCZ1FDbmZrZ2MrWUMwZktEUmk3TjJ6Q2xLL3ZHRzlMdTRQV3QxWVJZQUlEbU9GZTN2b01aUVpSQ3oKUGlFdmNQeFVEVC94bUR6dXo5aER1YmVJN1lGYUkyZ0JCUUhILzFJVWhkVlh6WlNYRXIzOEJobTk4RHBYT2UwdgplR0tPUko0dEV5d2hkcUNqSzBqYmxFMmNkK1JaVmZpY09SNXNIZ0ZPNFpzQ2J6UEpxWmMydFE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="l">eyJhbGciOiJSUzI1NiIsImtpZCI6Il82SWdMUWRGbnlHeGEtQnpReDVvUE9PWW9yWXY4cmg0NWdsT2ZiNTZiY0UifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJ4aW5uIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6Inhpbm4tdXNlcjIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoieGlubi11c2VyMiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6ImJkM2M2OTY3LTU2ZDAtNGMxOC05Mzg2LTgzZjI0OTIxMTVhMCIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDp4aW5uOnhpbm4tdXNlcjIifQ.A5c7l704dYJ10ftkqSEYjhPyO5AX7b-qKFVbAO4bk3xp2z6idfNo8suvZ9JiNhXzmMhIAa99aURbuUPeSZFHuIWBgUiU4lEAGlIfZJdgGbQan0qCxSfJpr9wKfPU3dgKo7PRnXhRyDtBwAFjrarlJu3CmnpJ_Ntz489s_ZIz1yJ4lTmcjqT9zElMj0Hxczm9zqxrt0BWYjQQIm4UgLOjEf2CkvJ-Ln8ucmRZLdZ4Hrvc9h5Sy1GvDIYJUKVCl4y_dnxD26wePmoJdn-WCA-GEYHE-BHsAeN_YdHDi1056NsUk05HZJ2EQNY57_IQctpffUxaQfKK-WRayyHiv1UE2g</span></span></span></code></pre></div><h4 id="469-登录测试">4.6.9 登录测试</h4>
<p>经测试更改绑定权限是实时生效的</p>
<div class="highlight" id="id-34"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@k8s-made-01-32:~# kubectl get pods --kubeconfig<span class="o">=</span>xinn-user2.kubeconfig
</span></span><span class="line"><span class="cl">NAME                                    READY   STATUS    RESTARTS   AGE
</span></span><span class="line"><span class="cl">xinn-web1-deployment-6b696577df-j7gbf   1/1     Running   <span class="m">0</span>          31d
</span></span><span class="line"><span class="cl">xinn-web1-deployment-6b696577df-ttwg8   1/1     Running   <span class="m">0</span>          31d
</span></span><span class="line"><span class="cl">xinn-web1-deployment-6b696577df-whmq8   1/1     Running   <span class="m">0</span>          31d</span></span></code></pre></div><p><strong>dashboard 登录测试</strong></p>
<p><img loading="lazy" src="https://cdn1.ryanxin.live/image-20240105102007044.png" srcset="https://cdn1.ryanxin.live/image-20240105102007044.png, https://cdn1.ryanxin.live/image-20240105102007044.png 1.5x, https://cdn1.ryanxin.live/image-20240105102007044.png 2x" sizes="auto" data-title="image-20240105102007044" data-alt="image-20240105102007044" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<div class="highlight" id="id-35"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">clusters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">cluster</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">certificate-authority-data</span><span class="p">:</span><span class="w"> </span><span class="l">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURtakNDQW9LZ0F3SUJBZ0lVTnhMZWE2QTZvVC9HL0dnR24rZ01uRDJjR2VBd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pERUxNQWtHQTFVRUJoTUNRMDR4RVRBUEJnTlZCQWdUQ0VoaGJtZGFhRzkxTVFzd0NRWURWUVFIRXdKWQpVekVNTUFvR0ExVUVDaE1EYXpoek1ROHdEUVlEVlFRTEV3WlRlWE4wWlcweEZqQVVCZ05WQkFNVERXdDFZbVZ5CmJtVjBaWE10WTJFd0lCY05Nak13TmpFME1EazBPVEF3V2hnUE1qRXlNekExTWpFd09UUTVNREJhTUdReEN6QUoKQmdOVkJBWVRBa05PTVJFd0R3WURWUVFJRXdoSVlXNW5XbWh2ZFRFTE1Ba0dBMVVFQnhNQ1dGTXhEREFLQmdOVgpCQW9UQTJzNGN6RVBNQTBHQTFVRUN4TUdVM2x6ZEdWdE1SWXdGQVlEVlFRREV3MXJkV0psY201bGRHVnpMV05oCk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBckNRN2VwV2RqTCtEMXNVY0FacXgKdjcrRGxIZm5aOFlNTmRXN25VNFk2ZHUyN2RUV3FpVFVjTllCK1RLR3RzRmJuODRkbEFtR04wZHpwcTZtNXlrdgppZWowS29SbjJMWDZmZHArNWRacXFKd1dMK0FsQXBycmY1cjYvNlRBaGNabGwvK1NaMnp3OFRldFVZY1ZFdzdzCit6ZDErelV6TkpMV25WdTByUitFeHNyTzNvdy85T0diTkdRaWk5d1RBRFR6MzlDQ09DQzdUZytIUVowQ3g2NGwKUE5IMjVKSmNYbjYxeXBUa0FwWXRiRUR2V29XWC9yYVJTcmZhclZObU1laFdKb2dSd2VsV1gydlM0cnAwVGdHWApyRGt3NHdNTUl0VmI1WmZoT3paTDV4QVRxZDlUcmRxWUVmZkRDSlNZam91c3VPL3FZSlZad1dTaXBxdXQ5V2c3CmVRSURBUUFCbzBJd1FEQU9CZ05WSFE4QkFmOEVCQU1DQVFZd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlYKSFE0RUZnUVVsbGxrNnl4SEdhTUpMOWtHUHJpV3JDdlY3bGd3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUc0UApIck5TOFpiRmQxTFZnMm5XT1RoTTVrUnZKSkdKZzUwcGlkTm9meTNMWVllVlUxMzZUeDBDZWxiaEZpS2l1SDhOCk9LVFI5cHRVYytXUDlaUlJUQkc0dkxCa3JxSlp3aXUxNUJXVThBT01Pcnhwd05xZlN1OVZFREtaMFRtUVVsWkEKVGxRdEczYk1sVFNpUkNZZXk0NjFQYVlpOE0vNUF1QjJqUDg2N09oUUhTaFdxN3RQUnJXSGFQZE1tekpKODBzUgpTRDNrRlYyUm5aemN5bGEzTFU1cWZaQUhTb20vL0tMb21oK0VlR2N4YWRVRlVwRUl4cDFVN3Z4YnRtRzByT2pKCitjNlJiWExZc2ZWRVNDOVEyUk10MTBUWCtYK1kwSGxzWHdlV0RiNXZOLzIwTlorTGtJR3E4cmNELytBZHhQd0YKcVI4R1hNSUY5TFhpdXk4ZWNjRT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l">https://10.1.0.32:6443</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xxcs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">contexts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">context</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l">xxcs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">xinn</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-prod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-prod</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">preferences</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">users</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="l">eyJhbGciOiJSUzI1NiIsImtpZCI6Il82SWdMUWRGbnlHeGEtQnpReDVvUE9PWW9yWXY4cmg0NWdsT2ZiNTZiY0UifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJ4aW5uIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6Inhpbm4tdXNlcjIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoieGlubi11c2VyMiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6ImJkM2M2OTY3LTU2ZDAtNGMxOC05Mzg2LTgzZjI0OTIxMTVhMCIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDp4aW5uOnhpbm4tdXNlcjIifQ.A5c7l704dYJ10ftkqSEYjhPyO5AX7b-qKFVbAO4bk3xp2z6idfNo8suvZ9JiNhXzmMhIAa99aURbuUPeSZFHuIWBgUiU4lEAGlIfZJdgGbQan0qCxSfJpr9wKfPU3dgKo7PRnXhRyDtBwAFjrarlJu3CmnpJ_Ntz489s_ZIz1yJ4lTmcjqT9zElMj0Hxczm9zqxrt0BWYjQQIm4UgLOjEf2CkvJ-Ln8ucmRZLdZ4Hrvc9h5Sy1GvDIYJUKVCl4y_dnxD26wePmoJdn-WCA-GEYHE-BHsAeN_YdHDi1056NsUk05HZJ2EQNY57_IQctpffUxaQfKK-WRayyHiv1UE2g</span></span></span></code></pre></div><div class="highlight" id="id-36"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1：指定了使用的 Kubernetes API 版本。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Config：定义了这是一个配置文件。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-prod：指定当前使用的上下文为 xinn-prod。上下文包含了一组集群、命名空间和用户的组合，指定了在使用 Kubernetes 命令时所操作的环境。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">preferences</span><span class="p">:</span><span class="w"> </span>{}<span class="l">：偏好设置为空，通常用于配置客户端行为，但在这个配置文件中未定义。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">clusters:：定义了集群信息，包括服务器地址和 CA 证书数据等。在你的配置文件中，只有一个集群信息：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xxcs：指定集群名称为 xxcs。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l">下包含了集群的详细信息：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">certificate-authority-data：该字段包含了 CA 证书的 Base64 编码数据，用于验证连接到 Kubernetes 集群的安全性。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">server：指定了 Kubernetes API 服务器的地址。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">contexts:：定义了上下文信息，包括集群、命名空间和用户的组合。在你的配置文件中有一个上下文：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-prod：指定上下文名称为 xinn-prod。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">下包含了该上下文的详细信息：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l">xxcs：指定该上下文所使用的集群名称为 xxcs。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">xinn：指定了命名空间为 xinn。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-user2：指定了该上下文使用的用户为 xinn-user2。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">users:：定义了用户信息，通常包含访问集群所需的凭据。在你的配置文件中有一个用户：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">xinn-prod：指定用户名称为 xinn-prod。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l">下包含了用户的详细信息，特别是认证信息：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">token：这是一个用于认证的 token，它以 Base64 编码形式表示，用于验证用户的身份并授权其访问 Kubernetes 集群。</span></span></span></code></pre></div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2024-01-04 00:00:00">更新于 2024-01-04&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"><span><a href="/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/index.md" title="阅读原始文档" class="link-to-markdown">阅读原始文档</a></span></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" data-title="kubernetes RBAC鉴权机制与多用户实例" data-hashtags="kubernetes基础"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" data-hashtag="kubernetes基础"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" data-title="kubernetes RBAC鉴权机制与多用户实例" data-web><i class="fa-brands fa-whatsapp fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" data-title="kubernetes RBAC鉴权机制与多用户实例"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" data-title="kubernetes RBAC鉴权机制与多用户实例"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Myspace" data-sharer="myspace" data-url="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" data-title="kubernetes RBAC鉴权机制与多用户实例" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Blogger" data-sharer="blogger" data-url="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" data-title="kubernetes RBAC鉴权机制与多用户实例" data-description=""><i class="fa-brands fa-blogger fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Evernote" data-sharer="evernote" data-url="https://hg-xnlog.github.io/posts/kubernetes/primary/kubernetes-rbac-and-multi-user-instances/" data-title="kubernetes RBAC鉴权机制与多用户实例"><i class="fa-brands fa-evernote fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/kubernetes%E5%9F%BA%E7%A1%80/' class="post-tag">kubernetes基础</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/20000/lesson5/" class="post-nav-item" rel="prev" title="lesson 5语音对应规则"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>lesson 5语音对应规则</a></div>
</div>
</article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2021 - 2024</span><span class="author" itemprop="copyrightHolder">
              <a href="https://github.com/ryanxin7"target="_blank" rel="external nofollow noopener noreferrer">Ryan</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class="site-time" title='网站运行中……'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden="true"></i><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><a href="https://github.com/ryanxin7" title="在 GitHub 上查看源代码"target="_blank" rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/algoliasearch/algoliasearch-lite.umd.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":80},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"enablePWA":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"HFAFNY4NX2","algoliaIndex":"xn-log","algoliaSearchKey":"bd08388586b2f88b20753c17c60ba92f","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"},"siteTime":"2021-09-09T09:09:09+09:00"};</script><script src="/js/theme.min.js" defer></script></body>
</html>
