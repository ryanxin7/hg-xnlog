<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>HAProxy-安装及基础配置（一） - Ryan&#39;s Notebook</title><meta name="author" content="Ryan">
<meta name="author-link" content="https://github.com/ryanxin7">
<meta name="description" content="三、HAProxy安装及基础配置 介绍HAProxy的基础安装及基础配置 3.1 源码包安装 官方提供了Ubuntu和Debian的包，没有Centos" /><meta name="keywords" content='负载均衡' /><meta itemprop="name" content="HAProxy-安装及基础配置（一）">
<meta itemprop="description" content="三、HAProxy安装及基础配置 介绍HAProxy的基础安装及基础配置 3.1 源码包安装 官方提供了Ubuntu和Debian的包，没有Centos"><meta itemprop="datePublished" content="2023-02-04T00:00:00+00:00" />
<meta itemprop="dateModified" content="2023-08-17T00:00:00+00:00" />
<meta itemprop="wordCount" content="2791"><meta itemprop="image" content="https://hg-xnlog.github.io/logo.png"/>
<meta itemprop="keywords" content="负载均衡," /><meta property="og:title" content="HAProxy-安装及基础配置（一）" />
<meta property="og:description" content="三、HAProxy安装及基础配置 介绍HAProxy的基础安装及基础配置 3.1 源码包安装 官方提供了Ubuntu和Debian的包，没有Centos" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" /><meta property="og:image" content="https://hg-xnlog.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-08-17T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://hg-xnlog.github.io/logo.png"/>

<meta name="twitter:title" content="HAProxy-安装及基础配置（一）"/>
<meta name="twitter:description" content="三、HAProxy安装及基础配置 介绍HAProxy的基础安装及基础配置 3.1 源码包安装 官方提供了Ubuntu和Debian的包，没有Centos"/>
<meta name="application-name" content="Ryan’s Notebook">
<meta name="apple-mobile-web-app-title" content="Ryan’s Notebook"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" /><link rel="next" href="https://hg-xnlog.github.io/posts/docker/docker%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8C%85%E6%96%B9%E5%BC%8F%E5%AE%89%E8%A3%85/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "HAProxy-安装及基础配置（一）",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/hg-xnlog.github.io\/posts\/haproxy\/haproxy-1\/"
    },"genre": "posts","keywords": "负载均衡","wordcount":  2791 ,
    "url": "https:\/\/hg-xnlog.github.io\/posts\/haproxy\/haproxy-1\/","datePublished": "2023-02-04T00:00:00+00:00","dateModified": "2023-08-17T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Ryan"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="wide"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper" data-github-corner="right">
    <div class="header-title">
      <a href="/" title="Ryan&#39;s Notebook"><img loading="lazy" src="/images/pow.png" srcset="/images/pow.png, /images/pow.png 1.5x, /images/pow.png 2x" sizes="auto" data-title="Ryan&#39;s Notebook" data-alt="Ryan&#39;s Notebook" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span class="header-title-text">Ryan’s Notebook</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 所有文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/friends/"
                title="友情链接"
                
              ><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-solid fa-user-tie fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Ryan&#39;s Notebook"><img loading="lazy" src="/images/pow.png" srcset="/images/pow.png, /images/pow.png 1.5x, /images/pow.png 2x" sizes="auto" data-title="/images/pow.png" data-alt="/images/pow.png" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span class="header-title-text">Ryan’s Notebook</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 所有文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/friends/"
                  title="友情链接"
                  
                ><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-solid fa-user-tie fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li
              class="menu-item text-center"
            ><a
                  class="menu-link"
                  href="https://github.com/ryanxin7/hg-xnlog"
                  title="GitHub"
                  rel="noopener noreferrer" target="_blank"
                ><i class='fa-brands fa-github fa-fw' aria-hidden='true'></i> </a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="toc" id="toc-auto"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>HAProxy-安装及基础配置（一）</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://github.com/ryanxin7" title="作者"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img loading="lazy" src="/images/avatar.png" srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes="auto" data-title="Ryan" data-alt="Ryan" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;Ryan</a></span>
          <span class="post-category">收录于 <a href="/categories/haproxy/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> HAProxy</a></span></div>
      <div class="post-meta-line"><span title="发布于 2023-02-04 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden="true"></i><time datetime="2023-02-04">2023-02-04</time></span>&nbsp;<span title="更新于 2023-08-17 00:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden="true"></i><time datetime="2023-08-17">2023-08-17</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 2791 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 6 分钟</span>&nbsp;<span id="busuanzi_container_page_pv" class="busuanzi_visitors comment-visitors" data-flag-title="HAProxy-安装及基础配置（一）">
            <i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_page_pv">-</span>&nbsp;次阅读
          </span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#三haproxy安装及基础配置">三、HAProxy安装及基础配置</a>
      <ul>
        <li><a href="#31-源码包安装">3.1 源码包安装</a></li>
        <li><a href="#32-编译安装haproxy">3.2 编译安装HAProxy</a></li>
        <li><a href="#33-验证haproxy状态">3.3 验证haproxy状态</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 id="三haproxy安装及基础配置">三、HAProxy安装及基础配置</h2>
<p>介绍HAProxy的基础安装及基础配置</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="31-源码包安装">3.1 源码包安装</h3>
<p>官方提供了Ubuntu和Debian的包，没有Centos的包<!-- raw HTML omitted --><img loading="lazy" src="http://cdn1.ryanxin.live/1675997727329-efbe55ed-cb1e-4446-b7d2-40fd13d1031b.png" srcset="http://cdn1.ryanxin.live/1675997727329-efbe55ed-cb1e-4446-b7d2-40fd13d1031b.png, http://cdn1.ryanxin.live/1675997727329-efbe55ed-cb1e-4446-b7d2-40fd13d1031b.png 1.5x, http://cdn1.ryanxin.live/1675997727329-efbe55ed-cb1e-4446-b7d2-40fd13d1031b.png 2x" sizes="auto" data-title="http://cdn1.ryanxin.live/1675997727329-efbe55ed-cb1e-4446-b7d2-40fd13d1031b.png" data-alt="http://cdn1.ryanxin.live/1675997727329-efbe55ed-cb1e-4446-b7d2-40fd13d1031b.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<hr>
<p><img loading="lazy" src="http://cdn1.ryanxin.live/xxlog/1675997822880-a7a98a7a-9d66-4040-902e-4575f17bcaf5.png" srcset="http://cdn1.ryanxin.live/xxlog/1675997822880-a7a98a7a-9d66-4040-902e-4575f17bcaf5.png, http://cdn1.ryanxin.live/xxlog/1675997822880-a7a98a7a-9d66-4040-902e-4575f17bcaf5.png 1.5x, http://cdn1.ryanxin.live/xxlog/1675997822880-a7a98a7a-9d66-4040-902e-4575f17bcaf5.png 2x" sizes="auto" data-title="image.png" data-alt="image.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="ubuntu-安装">ubuntu 安装</h4>
<div class="highlight" id="id-1"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">apt-get install --no-install-recommends software-properties-common </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#--no-install-recommends 参数来避免安装非必须的文件，从而减小镜像的体积</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">add-apt-repository ppa:vbernat/haproxy-2.6</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">apt-get install haproxy=2.6.\*</span></span></span></code></pre></div><div class="highlight" id="id-2"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#安装常用软件包</span>
</span></span><span class="line"><span class="cl">apt-get install --no-install-recommends software-properties-common -y
</span></span><span class="line"><span class="cl"><span class="c1">#--no-install-recommends 参数来避免安装非必须的文件，从而减小镜像的体积</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#安装源</span>
</span></span><span class="line"><span class="cl">root@etcd01<span class="o">[</span>11:10:22<span class="o">]</span>~ <span class="c1">#:add-apt-repository ppa:vbernat/haproxy-2.6</span>
</span></span><span class="line"><span class="cl"> HAProxy is a free, very fast and reliable solution offering high availability, load balancing, and proxying <span class="k">for</span> TCP and HTTP-based applications. It is particularly suited <span class="k">for</span> web sites crawling under very high loads <span class="k">while</span> needing persistence or Layer7 processing. Supporting tens of thousands of connections is clearly realistic with todays hardware. Its mode of operation makes its integration into existing architectures very easy and riskless, <span class="k">while</span> still offering the possibility not to expose fragile web servers to the Net.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This PPA contains packages <span class="k">for</span> HAProxy 2.6.
</span></span><span class="line"><span class="cl"> More info: https://launchpad.net/~vbernat/+archive/ubuntu/haproxy-2.6
</span></span><span class="line"><span class="cl">Press <span class="o">[</span>ENTER<span class="o">]</span> to <span class="k">continue</span> or Ctrl-c to cancel adding it.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Get:1 http://ppa.launchpad.net/vbernat/haproxy-2.6/ubuntu focal InRelease <span class="o">[</span>23.8 kB<span class="o">]</span>
</span></span><span class="line"><span class="cl">Hit:2 http://cn.archive.ubuntu.com/ubuntu focal InRelease 
</span></span><span class="line"><span class="cl">Hit:3 http://cn.archive.ubuntu.com/ubuntu focal-updates InRelease
</span></span><span class="line"><span class="cl">Hit:4 http://cn.archive.ubuntu.com/ubuntu focal-backports InRelease
</span></span><span class="line"><span class="cl">Hit:5 http://cn.archive.ubuntu.com/ubuntu focal-security InRelease         
</span></span><span class="line"><span class="cl">Get:6 http://ppa.launchpad.net/vbernat/haproxy-2.6/ubuntu focal/main amd64 Packages <span class="o">[</span>1,000 B<span class="o">]</span>
</span></span><span class="line"><span class="cl">Get:7 http://ppa.launchpad.net/vbernat/haproxy-2.6/ubuntu focal/main Translation-en <span class="o">[</span><span class="m">704</span> B<span class="o">]</span>
</span></span><span class="line"><span class="cl">Fetched 25.5 kB in 2s <span class="o">(</span>14.0 kB/s<span class="o">)</span>                     
</span></span><span class="line"><span class="cl">Reading package lists... Done
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#查看可用版本</span>
</span></span><span class="line"><span class="cl">root@etcd01<span class="o">[</span>11:11:01<span class="o">]</span>~ <span class="c1">#:apt-cache madison haproxy</span>
</span></span><span class="line"><span class="cl">   haproxy <span class="p">|</span> 2.6.8-1ppa1~focal <span class="p">|</span> http://ppa.launchpad.net/vbernat/haproxy-2.6/ubuntu focal/main amd64 Packages
</span></span><span class="line"><span class="cl">   haproxy <span class="p">|</span> 2.0.29-0ubuntu1.1 <span class="p">|</span> http://cn.archive.ubuntu.com/ubuntu focal-updates/main amd64 Packages
</span></span><span class="line"><span class="cl">   haproxy <span class="p">|</span> 2.0.29-0ubuntu1.1 <span class="p">|</span> http://cn.archive.ubuntu.com/ubuntu focal-security/main amd64 Packages
</span></span><span class="line"><span class="cl">   haproxy <span class="p">|</span>   2.0.13-2 <span class="p">|</span> http://cn.archive.ubuntu.com/ubuntu focal/main amd64 Packages
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#安装2.6</span>
</span></span><span class="line"><span class="cl">apt-get install <span class="nv">haproxy</span><span class="o">=</span>2.6.<span class="se">\*</span> -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#验证haproxy版本</span>
</span></span><span class="line"><span class="cl">root@etcd01<span class="o">[</span>13:50:48<span class="o">]</span>~ <span class="c1">#:haproxy -v</span>
</span></span><span class="line"><span class="cl">HAProxy version 2.6.8-1ppa1~focal 2023/01/24 - https://haproxy.org/
</span></span><span class="line"><span class="cl">Status: long-term supported branch - will stop receiving fixes around Q2 2027.
</span></span><span class="line"><span class="cl">Known bugs: http://www.haproxy.org/bugs/bugs-2.6.8.html
</span></span><span class="line"><span class="cl">Running on: Linux 5.4.0-135-generic <span class="c1">#152-Ubuntu SMP Wed Nov 23 20:19:22 UTC 2022 x86_64</span></span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="centos安装">Centos安装</h4>
<p>在centos系统上通过yum、编译等多种安装方式。<!-- raw HTML omitted --><strong>默认yum源</strong><!-- raw HTML omitted -->默认的base仓库中包含haproxy的安装包文件，但是版本比较旧，是1.5.18的版本，距离当前版本已经有较长时间没有更新，由于版本比较旧所以有很多功能不支持，如果对功能和性能没有要求可以使用此版本，否则推荐使用新版本。</p>
<div class="highlight" id="id-3"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># yum install haproxy -y</span>
</span></span><span class="line"><span class="cl"><span class="c1">#验证haproxy版本</span>
</span></span><span class="line"><span class="cl"><span class="c1"># haproxy -v</span>
</span></span><span class="line"><span class="cl">HA-Proxy version 1.5.18 2016/05/10
</span></span><span class="line"><span class="cl">Copyright 2000-2016 Willy Tarreau &lt;willy@haproxy.org&gt;</span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="32-编译安装haproxy">3.2 编译安装HAProxy</h3>
<p>编译安装HAProxy 2.0 LTS版本，源码包下载地址：<a href="http://www.haproxy.org/download/"target="_blank" rel="external nofollow noopener noreferrer">http://www.haproxy.org/download/</a></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="321-解决lua环境">3.2.1 解决lua环境</h4>
<p>HAProxy支持基于lua实现功能扩展，lua是一种小巧的脚本语言，于1993年由巴西里约热内卢天主教大学（Pontiﬁcal Catholic University of Rio de Janeiro）里的一个研究小组开发，其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定制功能。</p>
<p>Lua 官网：www.lua.org</p>
<div class="highlight" id="id-4"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Lua应用场景
</span></span><span class="line"><span class="cl">游戏开发
</span></span><span class="line"><span class="cl">独立应用脚本
</span></span><span class="line"><span class="cl">Web应用脚本
</span></span><span class="line"><span class="cl">扩展和数据库插件，如MySQL Proxy
</span></span><span class="line"><span class="cl">安全系统，如入侵检测系统</span></span></code></pre></div><hr>
<p><strong>Centos 环境</strong>：<!-- raw HTML omitted -->由于centos自带的lua版本比较低并不符合HAProxy要求的lua最低版本(5.3)的要求，因此需要编译安装较新版本的lua环境，然后才能编译安装HAProxy，过程如下：</p>
<div class="highlight" id="id-5"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#当前系统版本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1">#lua -v </span>
</span></span><span class="line"><span class="cl">Lua 5.1.4  Copyright <span class="o">(</span>C<span class="o">)</span> 1994-2008 Lua.org, PUC-Rio
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#安装基础命令及编译依赖环境</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># yum install gcc readline-devel</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># wget http://www.lua.org/ftp/lua-5.3.5.tar.gz</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># tar xvf  lua-5.3.5.tar.gz -C /usr/local/src</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cd /usr/local/src/lua-5.3.5</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 lua-5.3.5<span class="o">]</span><span class="c1"># make linux test</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost lua-5.3.5<span class="o">]</span><span class="c1"># make linux test</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> src <span class="o">&amp;&amp;</span> make linux
</span></span><span class="line"><span class="cl">make<span class="o">[</span>1<span class="o">]</span>: 进入目录“/usr/local/src/lua-5.3.5/src”
</span></span><span class="line"><span class="cl">make all <span class="nv">SYSCFLAGS</span><span class="o">=</span><span class="s2">&#34;-DLUA_USE_LINUX&#34;</span> <span class="nv">SYSLIBS</span><span class="o">=</span><span class="s2">&#34;-Wl,-E -ldl -lreadline&#34;</span>
</span></span><span class="line"><span class="cl">make<span class="o">[</span>2<span class="o">]</span>: 进入目录“/usr/local/src/lua-5.3.5/src”
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lapi.o lapi.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lcode.o lcode.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lctype.o lctype.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o ldebug.o ldebug.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o ldo.o ldo.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o ldump.o ldump.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lfunc.o lfunc.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lgc.o lgc.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o llex.o llex.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lmem.o lmem.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lobject.o lobject.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lopcodes.o lopcodes.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lparser.o lparser.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lstate.o lstate.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lstring.o lstring.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o ltable.o ltable.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o ltm.o ltm.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lundump.o lundump.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lvm.o lvm.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lzio.o lzio.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lauxlib.o lauxlib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lbaselib.o lbaselib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lbitlib.o lbitlib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lcorolib.o lcorolib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o ldblib.o ldblib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o liolib.o liolib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lmathlib.o lmathlib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o loslib.o loslib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lstrlib.o lstrlib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o ltablib.o ltablib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lutf8lib.o lutf8lib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o loadlib.o loadlib.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o linit.o linit.c
</span></span><span class="line"><span class="cl">ar rcu liblua.a lapi.o lcode.o lctype.o ldebug.o ldo.o ldump.o lfunc.o lgc.o llex.o lmem.o lobject.o lopcodes.o lparser.o lstate.o lstring.o ltable.o ltm.o lundump.o lvm.o lzio.o lauxlib.o lbaselib.o lbitlib.o lcorolib.o ldblib.o liolib.o lmathlib.o loslib.o lstrlib.o ltablib.o lutf8lib.o loadlib.o linit.o 
</span></span><span class="line"><span class="cl">ranlib liblua.a
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o lua.o lua.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -o lua   lua.o liblua.a -lm -Wl,-E -ldl -lreadline 
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_2 -DLUA_USE_LINUX    -c -o luac.o luac.c
</span></span><span class="line"><span class="cl">gcc -std<span class="o">=</span>gnu99 -o luac   luac.o liblua.a -lm -Wl,-E -ldl -lreadline 
</span></span><span class="line"><span class="cl">make<span class="o">[</span>2<span class="o">]</span>: 离开目录“/usr/local/src/lua-5.3.5/src”
</span></span><span class="line"><span class="cl">make<span class="o">[</span>1<span class="o">]</span>: 离开目录“/usr/local/src/lua-5.3.5/src”
</span></span><span class="line"><span class="cl">src/lua -v
</span></span><span class="line"><span class="cl">Lua 5.3.5  Copyright <span class="o">(</span>C<span class="o">)</span> 1994-2018 Lua.org, PUC-Rio
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#查看编译安装的版本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost lua-5.3.5<span class="o">]</span><span class="c1"># ./src/lua -v </span>
</span></span><span class="line"><span class="cl">Lua 5.3.5  Copyright <span class="o">(</span>C<span class="o">)</span> 1994-2018 Lua.org, PUC-Rio</span></span></code></pre></div><hr>
<p><strong>Ubuntu 基础环境</strong></p>
<div class="highlight" id="id-6"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#安装基础命令及编译依赖环境</span>
</span></span><span class="line"><span class="cl">$ apt  install gcc iproute2  ntpdate  tcpdump telnet traceroute nfs-kernel-server nfs-common  lrzsz tree  openssl libssl-dev libpcre3 libpcre3-dev zlib1g-dev  openssh-server  libreadline-dev libsystemd-dev
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> /usr/local/src
</span></span><span class="line"><span class="cl">$ wget http://www.lua.org/ftp/lua-5.3.5.tar.gz
</span></span><span class="line"><span class="cl">$ tar xvf  lua-5.3.5.tar.gz
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> lua-5.3.5
</span></span><span class="line"><span class="cl">$ make linux <span class="nb">test</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">/usr/local/src/lua-5.3.5
</span></span><span class="line"><span class="cl">$ ./src/lua -v
</span></span><span class="line"><span class="cl">Lua 5.3.5  Copyright <span class="o">(</span>C<span class="o">)</span> 1994-2018 Lua.org, PUC-Rio
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#或安装系统自带的lua</span>
</span></span><span class="line"><span class="cl">$ apt install  lua5.3<span class="o">=</span>5.3.3-1ubuntu0.18.04.1
</span></span><span class="line"><span class="cl">$ lua5.3  -v
</span></span><span class="line"><span class="cl">Lua 5.3.3  Copyright <span class="o">(</span>C<span class="o">)</span> 1994-2016 Lua.org, PUC-Rio</span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="322-开始编译安装">3.2.2 开始编译安装</h4>
<p><strong>Centos 环境</strong><!-- raw HTML omitted --><strong>ubuntu 系统推荐使用包管理器安装</strong></p>
<div class="highlight" id="id-7"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#HAProxy  1.8及1.9版本编译参数：</span>
</span></span><span class="line"><span class="cl">make  <span class="nv">ARCH</span><span class="o">=</span>x86_64 <span class="nv">TARGET</span><span class="o">=</span>linux2628 <span class="nv">USE_PCRE</span><span class="o">=</span><span class="m">1</span> <span class="nv">USE_OPENSSL</span><span class="o">=</span><span class="m">1</span> <span class="nv">USE_ZLIB</span><span class="o">=</span><span class="m">1</span> <span class="nv">USE_SYSTEMD</span><span class="o">=</span><span class="m">1</span>  <span class="nv">USE_CPU_AFFINITY</span><span class="o">=</span><span class="m">1</span>  <span class="nv">PREFIX</span><span class="o">=</span>/usr/local/haproxy 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#HAProxy 2.0以上版本编译参数：</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span>$ yum -y install gcc openssl-devel pcre-devel systemd-devel
</span></span><span class="line"><span class="cl">已安装:
</span></span><span class="line"><span class="cl">  openssl-devel.x86_64 1:1.0.2k-25.el7_9                              systemd-devel.x86_64 0:219-78.el7_9.7                             
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">作为依赖被安装:
</span></span><span class="line"><span class="cl">  keyutils-libs-devel.x86_64 0:1.5.8-3.el7       krb5-devel.x86_64 0:1.15.1-55.el7_9        libcom_err-devel.x86_64 0:1.42.9-19.el7      
</span></span><span class="line"><span class="cl">  libkadm5.x86_64 0:1.15.1-55.el7_9              libselinux-devel.x86_64 0:2.5-15.el7       libsepol-devel.x86_64 0:2.5-10.el7           
</span></span><span class="line"><span class="cl">  libverto-devel.x86_64 0:0.2.5-4.el7           
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">作为依赖被升级:
</span></span><span class="line"><span class="cl">  e2fsprogs.x86_64 0:1.42.9-19.el7            e2fsprogs-libs.x86_64 0:1.42.9-19.el7         krb5-libs.x86_64 0:1.15.1-55.el7_9         
</span></span><span class="line"><span class="cl">  libcom_err.x86_64 0:1.42.9-19.el7           libgudev1.x86_64 0:219-78.el7_9.7             libss.x86_64 0:1.42.9-19.el7               
</span></span><span class="line"><span class="cl">  openssl.x86_64 1:1.0.2k-25.el7_9            openssl-libs.x86_64 1:1.0.2k-25.el7_9         systemd.x86_64 0:219-78.el7_9.7            
</span></span><span class="line"><span class="cl">  systemd-libs.x86_64 0:219-78.el7_9.7        systemd-python.x86_64 0:219-78.el7_9.7        systemd-sysv.x86_64 0:219-78.el7_9.7 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span>$ tar xvf haproxy-2.6.8.tar.gz -C /usr/local/src/
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span>$ <span class="nb">cd</span> /usr/local/src/haproxy-2.6.8/
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 haproxy-2.6.8<span class="o">]</span>$ cat README 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The HAProxy documentation has been split into a number of different files <span class="k">for</span>
</span></span><span class="line"><span class="cl">ease of use.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Please refer to the following files depending on what you<span class="s1">&#39;re looking for :
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">  - INSTALL for instructions on how to build and install HAProxy
</span></span></span><span class="line"><span class="cl"><span class="s1">  - BRANCHES to understand the project&#39;</span>s life cycle and what version to use
</span></span><span class="line"><span class="cl">  - LICENSE <span class="k">for</span> the project<span class="s1">&#39;s license
</span></span></span><span class="line"><span class="cl"><span class="s1">  - CONTRIBUTING for the process to follow to submit contributions
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">The more detailed documentation is located into the doc/ directory :
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">  - doc/intro.txt for a quick introduction on HAProxy
</span></span></span><span class="line"><span class="cl"><span class="s1">  - doc/configuration.txt for the configuration&#39;</span>s reference manual
</span></span><span class="line"><span class="cl">  - doc/lua.txt <span class="k">for</span> the Lua<span class="s1">&#39;s reference manual
</span></span></span><span class="line"><span class="cl"><span class="s1">  - doc/SPOE.txt for how to use the SPOE engine
</span></span></span><span class="line"><span class="cl"><span class="s1">  - doc/network-namespaces.txt for how to use network namespaces under Linux
</span></span></span><span class="line"><span class="cl"><span class="s1">  - doc/management.txt for the management guide
</span></span></span><span class="line"><span class="cl"><span class="s1">  - doc/regression-testing.txt for how to use the regression testing suite
</span></span></span><span class="line"><span class="cl"><span class="s1">  - doc/peers.txt for the peers protocol reference
</span></span></span><span class="line"><span class="cl"><span class="s1">  - doc/coding-style.txt for how to adopt HAProxy&#39;</span>s coding style
</span></span><span class="line"><span class="cl">  - doc/internals <span class="k">for</span> developer-specific documentation <span class="o">(</span>not all up to date<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">----------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 haproxy-2.6.8<span class="o">]</span>$ cat INSTALL
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#参考INSTALL文件进行编译安装</span>
</span></span><span class="line"><span class="cl">$ make  <span class="nv">ARCH</span><span class="o">=</span>x86_64 <span class="nv">TARGET</span><span class="o">=</span>linux-glibc  <span class="nv">USE_PCRE</span><span class="o">=</span><span class="m">1</span> <span class="nv">USE_OPENSSL</span><span class="o">=</span><span class="m">1</span> <span class="nv">USE_ZLIB</span><span class="o">=</span><span class="m">1</span>  <span class="nv">USE_SYSTEMD</span><span class="o">=</span><span class="m">1</span> <span class="nv">USE_CPU_AFFINITY</span><span class="o">=</span><span class="m">1</span> <span class="nv">USE_LUA</span><span class="o">=</span><span class="m">1</span> <span class="nv">LUA_INC</span><span class="o">=</span>/usr/local/src/lua-5.3.5/src/  <span class="nv">LUA_LIB</span><span class="o">=</span>/usr/local/src/lua-5.3.5/src/ <span class="nv">PREFIX</span><span class="o">=</span>/usr/local/haproxy
</span></span><span class="line"><span class="cl">  CC      src/ev_poll.o
</span></span><span class="line"><span class="cl">  CC      src/ev_epoll.o
</span></span><span class="line"><span class="cl">  CC      src/cpuset.o
</span></span><span class="line"><span class="cl">  CC      src/ssl_sample.o
</span></span><span class="line"><span class="cl">  CC      src/ssl_sock.o
</span></span><span class="line"><span class="cl">  CC      src/ssl_crtlist.o
</span></span><span class="line"><span class="cl">  CC      src/ssl_ckch.o
</span></span><span class="line"><span class="cl">  CC      src/ssl_utils.o
</span></span><span class="line"><span class="cl">  CC      src/cfgparse-ssl.o
</span></span><span class="line"><span class="cl">  CC      src/jwt.o
</span></span><span class="line"><span class="cl">  CC      src/hlua.o
</span></span><span class="line"><span class="cl">  CC      src/hlua_fcn.o
</span></span><span class="line"><span class="cl">  CC      src/namespace.o
</span></span><span class="line"><span class="cl">  CC      src/mux_h2.o
</span></span><span class="line"><span class="cl">  CC      src/mux_fcgi.o
</span></span><span class="line"><span class="cl">  CC      src/mux_h1.o
</span></span><span class="line"><span class="cl">  CC      src/tcpcheck.o
</span></span><span class="line"><span class="cl">  CC      src/stream.o
</span></span><span class="line"><span class="cl">  CC      src/stats.o
</span></span><span class="line"><span class="cl">  CC      src/http_ana.o
</span></span><span class="line"><span class="cl">  CC      src/server.o
</span></span><span class="line"><span class="cl">  CC      src/stick_table.o
</span></span><span class="line"><span class="cl">  CC      src/sample.o
</span></span><span class="line"><span class="cl">  CC      src/flt_spoe.o
</span></span><span class="line"><span class="cl">  CC      src/tools.o
</span></span><span class="line"><span class="cl">  CC      src/log.o
</span></span><span class="line"><span class="cl">  CC      src/cfgparse.o
</span></span><span class="line"><span class="cl">  CC      src/peers.o
</span></span><span class="line"><span class="cl">  CC      src/backend.o
</span></span><span class="line"><span class="cl">  CC      src/resolvers.o
</span></span><span class="line"><span class="cl">  CC      src/cli.o
</span></span><span class="line"><span class="cl">  CC      src/connection.o
</span></span><span class="line"><span class="cl">  CC      src/proxy.o
</span></span><span class="line"><span class="cl">  CC      src/http_htx.o
</span></span><span class="line"><span class="cl">  CC      src/cfgparse-listen.o
</span></span><span class="line"><span class="cl">  CC      src/pattern.o
</span></span><span class="line"><span class="cl">  CC      src/check.o
</span></span><span class="line"><span class="cl">  CC      src/haproxy.o
</span></span><span class="line"><span class="cl">  CC      src/cache.o
</span></span><span class="line"><span class="cl">  CC      src/stconn.o
</span></span><span class="line"><span class="cl">  CC      src/http_act.o
</span></span><span class="line"><span class="cl">  CC      src/http_fetch.o
</span></span><span class="line"><span class="cl">  CC      src/http_client.o
</span></span><span class="line"><span class="cl">  CC      src/listener.o
</span></span><span class="line"><span class="cl">  CC      src/dns.o
</span></span><span class="line"><span class="cl">  CC      src/vars.o
</span></span><span class="line"><span class="cl">  CC      src/debug.o
</span></span><span class="line"><span class="cl">  CC      src/tcp_rules.o
</span></span><span class="line"><span class="cl">  CC      src/sink.o
</span></span><span class="line"><span class="cl">  CC      src/h1_htx.o
</span></span><span class="line"><span class="cl">  CC      src/task.o
</span></span><span class="line"><span class="cl">  CC      src/mjson.o
</span></span><span class="line"><span class="cl">  CC      src/h2.o
</span></span><span class="line"><span class="cl">  CC      src/filters.o
</span></span><span class="line"><span class="cl">  CC      src/server_state.o
</span></span><span class="line"><span class="cl">  CC      src/payload.o
</span></span><span class="line"><span class="cl">  CC      src/fcgi-app.o
</span></span><span class="line"><span class="cl">  CC      src/map.o
</span></span><span class="line"><span class="cl">  CC      src/htx.o
</span></span><span class="line"><span class="cl">  CC      src/h1.o
</span></span><span class="line"><span class="cl">  CC      src/pool.o
</span></span><span class="line"><span class="cl">  CC      src/cfgparse-global.o
</span></span><span class="line"><span class="cl">  CC      src/trace.o
</span></span><span class="line"><span class="cl">  CC      src/tcp_sample.o
</span></span><span class="line"><span class="cl">  CC      src/flt_http_comp.o
</span></span><span class="line"><span class="cl">  CC      src/mux_pt.o
</span></span><span class="line"><span class="cl">  CC      src/flt_trace.o
</span></span><span class="line"><span class="cl">  CC      src/mqtt.o
</span></span><span class="line"><span class="cl">  CC      src/acl.o
</span></span><span class="line"><span class="cl">  CC      src/sock.o
</span></span><span class="line"><span class="cl">  CC      src/mworker.o
</span></span><span class="line"><span class="cl">  CC      src/tcp_act.o
</span></span><span class="line"><span class="cl">  CC      src/ring.o
</span></span><span class="line"><span class="cl">  CC      src/session.o
</span></span><span class="line"><span class="cl">  CC      src/proto_tcp.o
</span></span><span class="line"><span class="cl">  CC      src/fd.o
</span></span><span class="line"><span class="cl">  CC      src/channel.o
</span></span><span class="line"><span class="cl">  CC      src/activity.o
</span></span><span class="line"><span class="cl">  CC      src/queue.o
</span></span><span class="line"><span class="cl">  CC      src/lb_fas.o
</span></span><span class="line"><span class="cl">  CC      src/http_rules.o
</span></span><span class="line"><span class="cl">  CC      src/extcheck.o
</span></span><span class="line"><span class="cl">  CC      src/thread.o
</span></span><span class="line"><span class="cl">  CC      src/http.o
</span></span><span class="line"><span class="cl">  CC      src/lb_chash.o
</span></span><span class="line"><span class="cl">  CC      src/applet.o
</span></span><span class="line"><span class="cl">  CC      src/compression.o
</span></span><span class="line"><span class="cl">  CC      src/raw_sock.o
</span></span><span class="line"><span class="cl">  CC      src/ncbuf.o
</span></span><span class="line"><span class="cl">  CC      src/frontend.o
</span></span><span class="line"><span class="cl">  CC      src/errors.o
</span></span><span class="line"><span class="cl">  CC      src/uri_normalizer.o
</span></span><span class="line"><span class="cl">  CC      src/http_conv.o
</span></span><span class="line"><span class="cl">  CC      src/lb_fwrr.o
</span></span><span class="line"><span class="cl">  CC      src/sha1.o
</span></span><span class="line"><span class="cl">  CC      src/proto_sockpair.o
</span></span><span class="line"><span class="cl">  CC      src/mailers.o
</span></span><span class="line"><span class="cl">  CC      src/lb_fwlc.o
</span></span><span class="line"><span class="cl">  CC      src/ebmbtree.o
</span></span><span class="line"><span class="cl">  CC      src/cfgcond.o
</span></span><span class="line"><span class="cl">  CC      src/action.o
</span></span><span class="line"><span class="cl">  CC      src/xprt_handshake.o
</span></span><span class="line"><span class="cl">  CC      src/protocol.o
</span></span><span class="line"><span class="cl">  CC      src/proto_uxst.o
</span></span><span class="line"><span class="cl">  CC      src/proto_udp.o
</span></span><span class="line"><span class="cl">  CC      src/lb_map.o
</span></span><span class="line"><span class="cl">  CC      src/fix.o
</span></span><span class="line"><span class="cl">  CC      src/ev_select.o
</span></span><span class="line"><span class="cl">  CC      src/arg.o
</span></span><span class="line"><span class="cl">  CC      src/sock_inet.o
</span></span><span class="line"><span class="cl">  CC      src/mworker-prog.o
</span></span><span class="line"><span class="cl">  CC      src/hpack-dec.o
</span></span><span class="line"><span class="cl">  CC      src/cfgparse-tcp.o
</span></span><span class="line"><span class="cl">  CC      src/sock_unix.o
</span></span><span class="line"><span class="cl">  CC      src/shctx.o
</span></span><span class="line"><span class="cl">  CC      src/proto_uxdg.o
</span></span><span class="line"><span class="cl">  CC      src/fcgi.o
</span></span><span class="line"><span class="cl">  CC      src/eb64tree.o
</span></span><span class="line"><span class="cl">  CC      src/clock.o
</span></span><span class="line"><span class="cl">  CC      src/chunk.o
</span></span><span class="line"><span class="cl">  CC      src/cfgdiag.o
</span></span><span class="line"><span class="cl">  CC      src/signal.o
</span></span><span class="line"><span class="cl">  CC      src/regex.o
</span></span><span class="line"><span class="cl">  CC      src/lru.o
</span></span><span class="line"><span class="cl">  CC      src/eb32tree.o
</span></span><span class="line"><span class="cl">  CC      src/eb32sctree.o
</span></span><span class="line"><span class="cl">  CC      src/cfgparse-unix.o
</span></span><span class="line"><span class="cl">  CC      src/hpack-tbl.o
</span></span><span class="line"><span class="cl">  CC      src/ebsttree.o
</span></span><span class="line"><span class="cl">  CC      src/ebimtree.o
</span></span><span class="line"><span class="cl">  CC      src/base64.o
</span></span><span class="line"><span class="cl">  CC      src/auth.o
</span></span><span class="line"><span class="cl">  CC      src/uri_auth.o
</span></span><span class="line"><span class="cl">  CC      src/time.o
</span></span><span class="line"><span class="cl">  CC      src/ebistree.o
</span></span><span class="line"><span class="cl">  CC      src/dynbuf.o
</span></span><span class="line"><span class="cl">  CC      src/wdt.o
</span></span><span class="line"><span class="cl">  CC      src/pipe.o
</span></span><span class="line"><span class="cl">  CC      src/init.o
</span></span><span class="line"><span class="cl">  CC      src/http_acl.o
</span></span><span class="line"><span class="cl">  CC      src/hpack-huff.o
</span></span><span class="line"><span class="cl">  CC      src/hpack-enc.o
</span></span><span class="line"><span class="cl">  CC      src/dict.o
</span></span><span class="line"><span class="cl">  CC      src/freq_ctr.o
</span></span><span class="line"><span class="cl">  CC      src/ebtree.o
</span></span><span class="line"><span class="cl">  CC      src/hash.o
</span></span><span class="line"><span class="cl">  CC      src/dgram.o
</span></span><span class="line"><span class="cl">  CC      src/version.o
</span></span><span class="line"><span class="cl">  LD      haproxy
</span></span><span class="line"><span class="cl">  CC      dev/flags/flags.o
</span></span><span class="line"><span class="cl">  LD      dev/flags/flags
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ make install <span class="nv">PREFIX</span><span class="o">=</span>/usr/local/haproxy
</span></span><span class="line"><span class="cl">$ ln -s /usr/local/haproxy/sbin/haproxy /usr/sbin/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#验证版本</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost haproxy<span class="o">]</span><span class="c1"># haproxy -v</span>
</span></span><span class="line"><span class="cl">HAProxy version 2.6.8-ab6ee7f 2023/01/24 - https://haproxy.org/
</span></span><span class="line"><span class="cl">Status: long-term supported branch - will stop receiving fixes around Q2 2027.
</span></span><span class="line"><span class="cl">Known bugs: http://www.haproxy.org/bugs/bugs-2.6.8.html
</span></span><span class="line"><span class="cl">Running on: Linux 3.10.0-1127.8.2.el7.x86_64 <span class="c1">#1 SMP Tue May 12 16:57:42 UTC 2020 x86_64</span></span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="323-haproxy启动脚本">3.2.3 HAProxy启动脚本</h4>
<div class="highlight" id="id-8"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim   /usr/lib/systemd/system/haproxy.service
</span></span><span class="line"><span class="cl"><span class="o">[</span>Unit<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Description</span><span class="o">=</span>HAProxy Load Balancer
</span></span><span class="line"><span class="cl"><span class="nv">After</span><span class="o">=</span>syslog.target network.target
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Service<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">ExecStartPre</span><span class="o">=</span>/usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg  -c -q
</span></span><span class="line"><span class="cl"><span class="nv">ExecStart</span><span class="o">=</span>/usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -p /var/lib/haproxy/haproxy.pid
</span></span><span class="line"><span class="cl"><span class="nv">ExecReload</span><span class="o">=</span>/bin/kill -USR2 <span class="nv">$MAINPID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Install<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target</span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="324-创建配置文件">3.2.4 创建配置文件</h4>
<div class="highlight" id="id-9"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir  /etc/haproxy
</span></span><span class="line"><span class="cl">vim /etc/haproxy/haproxy.cfg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">global
</span></span><span class="line"><span class="cl">    maxconn <span class="m">100000</span>
</span></span><span class="line"><span class="cl">    chroot /apps/haproxy
</span></span><span class="line"><span class="cl">    stats socket /var/lib/haproxy/haproxy.sock mode <span class="m">600</span> level admin
</span></span><span class="line"><span class="cl">    <span class="c1">#uid 99</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#gid 99</span>
</span></span><span class="line"><span class="cl">    user  haproxy
</span></span><span class="line"><span class="cl">    group haproxy
</span></span><span class="line"><span class="cl">    daemon
</span></span><span class="line"><span class="cl">    <span class="c1">#nbproc 4</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#cpu-map 1 0</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#cpu-map 2 1</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#cpu-map 3 2</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#cpu-map 4 3</span>
</span></span><span class="line"><span class="cl">    pidfile /var/lib/haproxy/haproxy.pid
</span></span><span class="line"><span class="cl">    log 127.0.0.1 local2 info
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">defaults
</span></span><span class="line"><span class="cl">    option http-keep-alive
</span></span><span class="line"><span class="cl">    option  forwardfor
</span></span><span class="line"><span class="cl">    maxconn <span class="m">100000</span>
</span></span><span class="line"><span class="cl">    mode http
</span></span><span class="line"><span class="cl">    timeout connect 300000ms
</span></span><span class="line"><span class="cl">    timeout client  300000ms
</span></span><span class="line"><span class="cl">    timeout server  300000ms
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">listen stats
</span></span><span class="line"><span class="cl">    mode http
</span></span><span class="line"><span class="cl">    <span class="nb">bind</span> 0.0.0.0:9999
</span></span><span class="line"><span class="cl">    stats <span class="nb">enable</span>
</span></span><span class="line"><span class="cl">    log global
</span></span><span class="line"><span class="cl">    stats uri     /haproxy-status
</span></span><span class="line"><span class="cl">    stats auth    haadmin:123456
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">listen  web_port
</span></span><span class="line"><span class="cl">    <span class="nb">bind</span> 10.1.0.6:30013
</span></span><span class="line"><span class="cl">    mode http
</span></span><span class="line"><span class="cl">    option forwardfor
</span></span><span class="line"><span class="cl">    log global
</span></span><span class="line"><span class="cl">    server web1  10.1.0.31:30013  check inter <span class="m">3000</span> fall <span class="m">2</span> rise <span class="m">5</span></span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="325--启动haproxy">3.2.5  启动haproxy</h4>
<div class="highlight" id="id-10"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir  /var/lib/haproxy
</span></span><span class="line"><span class="cl">chown  -R 99.99 /var/lib/haproxy/ 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">useradd -r -s /sbin/nologin -d /var/lib/haproxy haproxy
</span></span><span class="line"><span class="cl">systemctl daemon-reload
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl start haproxy
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> haproxy
</span></span><span class="line"><span class="cl">systemctl status haproxy</span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="33-验证haproxy状态">3.3 验证haproxy状态</h3>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="331-验证监听端口">3.3.1 验证监听端口</h4>
<div class="highlight" id="id-11"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost haproxy<span class="o">]</span><span class="c1"># ss -tnl</span>
</span></span><span class="line"><span class="cl">State       Recv-Q Send-Q          Local Address:Port      Peer Address:Port              
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">128</span>                 127.0.0.1:631                  *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">100</span>                         *:8088                 *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">3</span>                   127.0.0.1:31769                *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">100</span>                 127.0.0.1:25                   *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">128</span>                         *:1883                 *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">128</span>                         *:30013                *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">50</span>                          *:8161                 *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">1</span>                   127.0.0.1:8005                 *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">128</span>                         *:5672                 *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">50</span>                          *:43178                *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">128</span>                         *:6379                 *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">128</span>                         *:61613                *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">50</span>                          *:61614                *:*                  
</span></span><span class="line"><span class="cl">LISTEN      <span class="m">0</span>      <span class="m">128</span>                         *:9999                 *:* </span></span></code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="332-查看haproxy的状态页面">3.3.2 查看haproxy的状态页面</h4>
<p>浏览器访问：<a href="http://www.yunweipai.com/go?_=84a56fb1feaHR0cDovL2hhcHJveHktc2VydmVyOjk5OTkvaGFwcm94eS1zdGF0dXM%3D"target="_blank" rel="external nofollow noopener noreferrer">http://haproxy-server:9999/haproxy-status</a><!-- raw HTML omitted --><img loading="lazy" src="http://cdn1.ryanxin.live/1676021477593-8a91dd15-dde3-4cc1-a009-f117f39f08f9.png" srcset="http://cdn1.ryanxin.live/1676021477593-8a91dd15-dde3-4cc1-a009-f117f39f08f9.png, http://cdn1.ryanxin.live/1676021477593-8a91dd15-dde3-4cc1-a009-f117f39f08f9.png 1.5x, http://cdn1.ryanxin.live/1676021477593-8a91dd15-dde3-4cc1-a009-f117f39f08f9.png 2x" sizes="auto" data-title="http://cdn1.ryanxin.live/1676021477593-8a91dd15-dde3-4cc1-a009-f117f39f08f9.png" data-alt="http://cdn1.ryanxin.live/1676021477593-8a91dd15-dde3-4cc1-a009-f117f39f08f9.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="333-测试转发">3.3.3 测试转发</h4>
<p>10.1.0.6:30013 转发到 10.1.0.31:30013 ✅</p>
<p><img loading="lazy" src="http://cdn1.ryanxin.live/1676254179452-d15ddfd6-e6e2-4d2c-8d3a-691d48309fcf.png" srcset="http://cdn1.ryanxin.live/1676254179452-d15ddfd6-e6e2-4d2c-8d3a-691d48309fcf.png, http://cdn1.ryanxin.live/1676254179452-d15ddfd6-e6e2-4d2c-8d3a-691d48309fcf.png 1.5x, http://cdn1.ryanxin.live/1676254179452-d15ddfd6-e6e2-4d2c-8d3a-691d48309fcf.png 2x" sizes="auto" data-title="http://cdn1.ryanxin.live/1676254179452-d15ddfd6-e6e2-4d2c-8d3a-691d48309fcf.png" data-alt="http://cdn1.ryanxin.live/1676254179452-d15ddfd6-e6e2-4d2c-8d3a-691d48309fcf.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2023-08-17 00:00:00">更新于 2023-08-17&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"><span><a href="/posts/haproxy/haproxy-1/index.md" title="阅读原始文档" class="link-to-markdown">阅读原始文档</a></span></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" data-title="HAProxy-安装及基础配置（一）" data-hashtags="负载均衡"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" data-hashtag="负载均衡"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" data-title="HAProxy-安装及基础配置（一）" data-web><i class="fa-brands fa-whatsapp fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" data-title="HAProxy-安装及基础配置（一）"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" data-title="HAProxy-安装及基础配置（一）"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Myspace" data-sharer="myspace" data-url="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" data-title="HAProxy-安装及基础配置（一）" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Blogger" data-sharer="blogger" data-url="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" data-title="HAProxy-安装及基础配置（一）" data-description=""><i class="fa-brands fa-blogger fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Evernote" data-sharer="evernote" data-url="https://hg-xnlog.github.io/posts/haproxy/haproxy-1/" data-title="HAProxy-安装及基础配置（一）"><i class="fa-brands fa-evernote fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/' class="post-tag">负载均衡</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav">
      <a href="/posts/docker/docker%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8C%85%E6%96%B9%E5%BC%8F%E5%AE%89%E8%A3%85/" class="post-nav-item" rel="next" title="Docker 二进制方式安装">Docker 二进制方式安装<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2021 - 2023</span><span class="author" itemprop="copyrightHolder">
              <a href="https://github.com/ryanxin7"target="_blank" rel="external nofollow noopener noreferrer">Ryan</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class="site-time" title='网站运行中……'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden="true"></i><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><a href="https://github.com/ryanxin7" title="在 GitHub 上查看源代码"target="_blank" rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/algoliasearch/algoliasearch-lite.umd.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"enablePWA":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"HFAFNY4NX2","algoliaIndex":"xn-log","algoliaSearchKey":"bd08388586b2f88b20753c17c60ba92f","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"},"siteTime":"2021-09-09T09:09:09+09:00"};</script><script src="/js/theme.min.js" defer></script></body>
</html>
